package testCases

import static com.kms.katalon.core.checkpoint.CheckpointFactory.findCheckpoint
import static com.kms.katalon.core.testcase.TestCaseFactory.findTestCase
import static com.kms.katalon.core.testdata.TestDataFactory.findTestData
import static com.kms.katalon.core.testobject.ObjectRepository.findTestObject

import com.kms.katalon.core.annotation.Keyword
import com.kms.katalon.core.checkpoint.Checkpoint
import com.kms.katalon.core.cucumber.keyword.CucumberBuiltinKeywords as CucumberKW
import com.kms.katalon.core.mobile.keyword.MobileBuiltInKeywords as Mobile
import com.kms.katalon.core.model.FailureHandling
import com.kms.katalon.core.testcase.TestCase
import com.kms.katalon.core.testdata.TestData
import com.kms.katalon.core.testobject.TestObject
import com.kms.katalon.core.webservice.keyword.WSBuiltInKeywords as WS
import com.kms.katalon.core.webui.keyword.WebUiBuiltInKeywords as WebUI

import internal.GlobalVariable
import reportfolio.Reportfolio

public class DisplayIterationAndCsvSettings extends Reportfolio {

	@Keyword
	public void cumulativeCsvWithEmptyLines () {
		// Daily - Start from row
		String page = "folders"
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (selenium.isVisible("css=button[id=\"button-new-folder\"]")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		selenium.click("css=button[id=\"button-new-folder\"]")
		selenium.type("css=div.mat-form-field-infix > input.mat-input-element", "Test auto - Folder - CSV Settings Daily")
		selenium.click("css=app-new-document-dialog > form > mat-dialog-actions > button.mat-raised-button.mat-accent > span")
		Thread.sleep(1500);
		selenium.click("css=button[id=\"button-new-report\"]")
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (selenium.isVisible("css=button[id=\"button-new-basic-report\"]")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		selenium.click("css=button[id=\"button-new-basic-report\"]")
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (selenium.isVisible("css=div > mat-dialog-container")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		selenium.click("css=mat-dialog-content div.mat-form-field-flex > div > mat-select")
		Thread.sleep(500);
		selenium.click("css=div[class=\"cdk-overlay-pane\"] > div > mat-option:nth-child(1)")
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (selenium.isVisible("css=div.mat-form-field-infix > input.mat-input-element")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		selenium.type("css=div.mat-form-field-infix > input.mat-input-element", "Test auto - Report - CSV Settings Daily Start from row")
		selenium.click("css=app-new-document-dialog > form > mat-dialog-actions > button.mat-raised-button.mat-accent > span")
		Thread.sleep(1000);
		selenium.click("css=subreport > div > header > div > button > span > i")
		selenium.click("css=div.mat-menu-content > button:nth-child(1)")
		selenium.click("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > i")
		selenium.type("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > input", "Start from row Subreport")
		selenium.fireEvent("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > input", "blur")
		selenium.click("css=document-setup > mat-card > mat-card-content > div.option.schedule > button")
		selenium.click("css=sat-datepicker-toggle > button")
		selenium.click("css=.mat-calendar-body-today")
		selenium.click("css=.mat-calendar-body-today")
		selenium.click("css=document-scheduler > div.mat-dialog-actions > button.mat-raised-button.mat-accent")
		Thread.sleep(500);
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (!selenium.isVisible("xpath=//*[text()='No report yet']")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		selenium.type("css=document-setup > mat-card > mat-card-content > div:nth-child(3) > form > button > span > input", "${templateFullPath}")
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (selenium.isVisible("css=document-setup > mat-card > mat-card-content > div:nth-child(3) > button:nth-of-type(2)")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		selenium.click("css=document-setup > mat-card > mat-card-content > div:nth-child(3) > button:nth-of-type(2)")
		selenium.type("css=section.display-sheets > table > tbody > tr:nth-child(1) > td.mat-cell.cdk-column-xls_sheet_index.mat-column-xls_sheet_index.ng-star-inserted > input", "8")
		System.out.println("ISSUE WITH OPTION css=section.display-sheets > table > tbody > tr:nth-child(1) > td:nth-of-type(4) > mat-checkbox > label > div");
		selenium.click("css=section.display-sheets > table > tbody > tr:nth-child(1) > td:nth-of-type(5) > mat-checkbox > label > div")
		selenium.fireEvent("css= td.cdk-column-xls_sheet_index.mat-column-xls_sheet_index > input", "change")
		selenium.click("css=app-document-settings > mat-dialog-actions > button.mat-raised-button.mat-accent")
		selenium.click("css=app-document > section > subreport > div > sheet > mat-card > div > div > button > span > span")
		selenium.type("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div > div:nth-child(2) > div:nth-child(1) > input", "14")
		selenium.select("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div > div:nth-child(3) > div:nth-child(1) > select", "value=;")
		selenium.click("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div > div:nth-child(3) > div:nth-child(2) > input")
		selenium.click("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div:nth-child(2) > button")
		Thread.sleep(1500);
		selenium.refresh()
		selenium.waitForPageToLoad("")
		selenium.click("css=app-document > section > subreport > div > sheet > mat-card > div > div > button > span > span")
		selenium.type("css=input#fileUpload", "${biggerCsvFullPath}")
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (selenium.isVisible("css=div.preview-info")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		String currentDate = selenium.getEval("var today = new Date(); today.toISOString().substring(0,10);")
		verifyEquals("Cumulated CSV of 1 iterations - Total rows : 796", selenium.getText("css=div.preview-info"));
		assertEquals("Header of first CSV (containing empty lines) at line 14PlacementDateDBM Cost (Account Currency)OR-Mobile_2018-01_Sales : or_mobile_cv_acquisition-terminal _2018-01: Total ConversionsOR-Mobile_2018-01_Sales : or_mobile_cv_fidelisation-terminal_2018-01: Total ConversionsOR-Mobile_2018-01_Sales : or_mobile_cv_acquisition-forfait-multi-ligne_2018-01: Total ConversionsOR-Mobile_2018-01_Sales : or_mobile_cv_acquisition-forfait_2018-01: Total ConversionsSH-Mobile_2018-01_Sales : sh_mobile_cv_acquisition-offre-mobile_2018-01: Total ConversionsSH-Mobile_2018-01_Sales : sh_mobile_cv_acquisition-terminal _2018-01: Total ConversionsOR-FAI_2018-01_Sales : or_fai_cv_confirmation-acquisition-internet-fibre_2018-01: Total ConversionsOR-FAI_2018-01_Sales : or_fai_cv_confirmation-migration-xdsl-vers-fibre_2018-01: Total ConversionsOR-Open_2018-01_Sales : or_open_cv_acquisition-open-fibre_2018-05: Total ConversionsOR-Open_2018-01_Sales : or_open_cv_migration-open-xdsl-vers-fibre_2018-01: Total ConversionsOR-FAI_2018-01_Sales : or_fai_cv_confirmation-acquisition-internet-xdsl_2018-01: Total ConversionsOR-Open_2018-01_Sales : or_open_cv_acquisition-open-xdsl_2018-01: Total ConversionsSH-Mobile-Livebox_2018-01_Sales : sh_mobile-livebox_cv_acq-offre-convergente_2018-01: Total ConversionsSH-Box-Internet_2018-08_Sales : sh_box-internet_cv_confirmation-acquisition-internet-adsl_2018-08: Total ConversionsSH-Box-Internet_2018-08_Sales : sh_box-internet_cv_confirmation-acquisition-internet-fibre_2018-10: Total ConversionsFR Orange Internet22183140_tradelab_odr_pcc_multi-format-native1_cpm_mob_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20194.080.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_pcc_multi-format-native1_cpm_web_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20190.830.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_pcc_multi-format-native2_cpm_mob_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20195.290.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00Next line is empty22183140_tradelab_odr_pcc_multi-format-native2_cpm_web_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20194.570.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_pcc_multi-format-native3_cpm_web_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20194.620.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00Next line only separators22183140_tradelab_odr_std_120x600_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms__or-fai_kpi1-acquisition-bb19/02/20191.540.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_std_1800x1000_cpm_web_dis-eve_rtg_npa_retargeting_dbm_1st-tms__or-fai_kpi1-acquisition-bb19/02/201910.210.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_std_300x250_cpm_mob_dis-iab_rtg_npa_retargeting_dbm_1st-tms__or-fai_kpi1-acquisition-bb19/02/201927.220.000.000.000.000.000.000.000.000.000.001.000.000.000.000.00", selenium.getText("css=table.preview-table:nth-of-type(1)"));
		verifyTrue(selenium.isVisible("css=div.spliter"));
		assertEquals("FR Sosh Mobile22330690_tradelab_terminaux_std_160x600_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201931.520.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_300x250_cpm_mob_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201919.710.000.000.000.000.001.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_300x250_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/2019161.630.000.000.000.004.001.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_300x50_cpm_mob_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/20199.980.000.000.000.000.000.000.000.000.000.000.000.000.001.000.00Next line only separators22330690_tradelab_terminaux_std_300x600_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/2019130.010.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_320x50_cpm_mob_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201910.450.000.000.000.000.001.000.000.000.000.000.000.000.000.001.00Next line is empty22330690_tradelab_terminaux_std_728x90_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201990.440.000.000.000.004.000.000.000.000.000.000.000.000.000.000.00Last line of the first CSV (containing empty lines)------13367.257.0029.008.0013.0051.0014.003.001.001.000.008.000.000.0011.009.00", selenium.getText("css=table.preview-table:nth-of-type(2)"));
		selenium.if("${downloadReport} == 1")
		selenium.click("css=document-setup > div > div > button:nth-of-type(3)")
		String waitForReport = "5000"
		String remainingAttempts = "40"
		boolean canDownloadReport = selenium.isElementPresent("css=div.cdk-overlay-pane > div > div > button[aria-disabled=\"false\"]")
		selenium.while(canDownloadReport + " == 0 && " + remainingAttempts + " > 0")
		Thread.sleep(NaN);
		selenium.refresh()
		selenium.waitForPageToLoad("")
		selenium.click("css=document-setup > div > div > button:nth-of-type(3)")
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (selenium.isVisible("css=div.cdk-overlay-pane > div > div > button")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		boolean canDownloadReport = selenium.isElementPresent("css=div.cdk-overlay-pane > div > div > button[aria-disabled=\"false\"]")
		String remainingAttempts = selenium.getEval("remainingAttempts - 1")
		selenium.endWhile()
		selenium.click("css=div.cdk-overlay-pane > div > div > button[aria-disabled=\"false\"]")
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (selenium.isVisible("css=snack-bar-container > simple-snack-bar")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		selenium.endIf()
		// Daily - Exclude last
		selenium.open("https://${currentEnvironment}${tiret}${currentWebsite}/${page}")
		Thread.sleep(2000);
		selenium.click("css=button[id=\"button-new-report\"]")
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (selenium.isVisible("css=button[id=\"button-new-basic-report\"]")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		selenium.click("css=button[id=\"button-new-basic-report\"]")
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (selenium.isVisible("css=div > mat-dialog-container")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		selenium.click("css=mat-dialog-content div.mat-form-field-flex > div > mat-select")
		Thread.sleep(500);
		selenium.click("css=div[class=\"cdk-overlay-pane\"] > div > mat-option:nth-child(1)")
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (selenium.isVisible("css=div.mat-form-field-infix > input.mat-input-element")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		selenium.type("css=div.mat-form-field-infix > input.mat-input-element", "Test auto - Report - CSV Settings Daily Exclude last")
		selenium.click("css=app-new-document-dialog > form > mat-dialog-actions > button.mat-raised-button.mat-accent > span")
		Thread.sleep(1000);
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (selenium.isVisible("css=span.no-source")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		selenium.click("css=subreport > div > header > div > button > span > i")
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (selenium.isVisible("css=div.mat-menu-content > button:nth-child(1)")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		selenium.click("css=div.mat-menu-content > button:nth-child(1)")
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (selenium.isVisible("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > i")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		selenium.click("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > i")
		selenium.type("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > input", "Exclude last Subreport")
		selenium.fireEvent("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > input", "blur")
		selenium.click("css=document-setup > mat-card > mat-card-content > div.option.schedule > button")
		selenium.click("css=sat-datepicker-toggle > button")
		selenium.click("css=.mat-calendar-body-today")
		selenium.click("css=.mat-calendar-body-today")
		selenium.click("css=document-scheduler > div.mat-dialog-actions > button.mat-raised-button.mat-accent")
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (!selenium.isVisible("xpath=//*[text()='No report yet']")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		selenium.type("css=document-setup > mat-card > mat-card-content > div:nth-child(3) > form > button > span > input", "${templateFullPath}")
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (selenium.isVisible("css=document-setup > mat-card > mat-card-content > div:nth-child(3) > button:nth-of-type(2)")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		selenium.click("css=document-setup > mat-card > mat-card-content > div:nth-child(3) > button:nth-of-type(2)")
		selenium.type("css=section.display-sheets > table > tbody > tr:nth-child(1) > td.mat-cell.cdk-column-xls_sheet_index.mat-column-xls_sheet_index.ng-star-inserted > input", "8")
		System.out.println("ISSUE WITH OPTION css=section.display-sheets > table > tbody > tr:nth-child(1) > td:nth-of-type(4) > mat-checkbox > label > div");
		selenium.click("css=section.display-sheets > table > tbody > tr:nth-child(1) > td:nth-of-type(5) > mat-checkbox > label > div")
		selenium.fireEvent("css= td.cdk-column-xls_sheet_index.mat-column-xls_sheet_index > input", "change")
		selenium.click("css=app-document-settings > mat-dialog-actions > button.mat-raised-button.mat-accent")
		selenium.click("css=app-document > section > subreport > div > sheet > mat-card > div > div > button > span > span")
		selenium.type("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div > div:nth-child(2) > div:nth-child(2) > input", "14")
		selenium.select("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div > div:nth-child(3) > div:nth-child(1) > select", "value=;")
		selenium.click("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div > div:nth-child(3) > div:nth-child(2) > input")
		selenium.click("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div:nth-child(2) > button")
		Thread.sleep(1500);
		selenium.refresh()
		selenium.waitForPageToLoad("")
		selenium.click("css=app-document > section > subreport > div > sheet > mat-card > div > div > button > span > span")
		selenium.type("css=input#fileUpload", "${biggerCsvFullPath}")
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (selenium.isVisible("css=div.preview-info")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		String currentDate = selenium.getEval("var today = new Date(); today.toISOString().substring(0,10);")
		verifyEquals("Cumulated CSV of 1 iterations - Total rows : 795", selenium.getText("css=div.preview-info"));
		assertEquals("First line of first CSV (containing empty lines)Next line is empty2/20/19 4:39 AMReport Time ZoneEurope/ParisAccount ID743372Date Range2/19/19 - 2/19/19AdvertiserEquals:FR Orange Internet (8364571)AdvertiserEquals:FR Orange Mobile (8365738)Next line only separatorsEquals:FR Sosh Mobile (8364118)AdvertiserEquals:FR Sosh Internet (8364841)", selenium.getText("css=table.preview-table:nth-of-type(1)"));
		verifyTrue(selenium.isVisible("css=div.spliter"));
		assertEquals("FR Sosh Mobile22275335_tradelab_stvalentin_std_300x600_cpm_web_dis-iab_prosp_npa_profiling_dbm_3rd-classique_sosh_kpi4-terminaux-mobile19/02/2019162.900.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22275335_tradelab_stvalentin_std_300x600_cpm_web_dis-iab_prosp_npa_prospectionalgo_dbm_ _sosh_kpi4-terminaux-mobile_kpi4-terminaux-mobile19/02/201963.250.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00Next line is empty22330690_tradelab_terminaux_std_728x90_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201990.440.000.000.000.004.000.000.000.000.000.000.000.000.000.000.00Next line only separators22330690_tradelab_terminaux_std_300x600_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/2019130.010.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22275335_tradelab_stvalentin_std_320x50_cpm_mob_dis-iab_prosp_npa_prospectionalgo_dbm_ _sosh_kpi4-terminaux-mobile_kpi4-terminaux-mobile19/02/201930.550.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22275335_tradelab_stvalentin_std_728x90_cpm_web_dis-iab_prosp_npa_profiling_dbm_2nd-tl_sosh_kpi4-terminaux-mobile19/02/20190.620.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22275335_tradelab_stvalentin_std_728x90_cpm_web_dis-iab_prosp_npa_profiling_dbm_3rd-classique_sosh_kpi4-terminaux-mobile19/02/2019124.150.000.000.000.004.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22275335_tradelab_stvalentin_std_728x90_cpm_web_dis-iab_prosp_npa_prospectionalgo_dbm_ _sosh_kpi4-terminaux-mobile_kpi4-terminaux-mobile19/02/201942.060.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00", selenium.getText("css=table.preview-table:nth-of-type(2)"));
		selenium.if("${downloadReport} == 1")
		selenium.click("css=document-setup > div > div > button:nth-of-type(3)")
		String waitForReport = "5000"
		String remainingAttempts = "40"
		boolean canDownloadReport = selenium.isElementPresent("css=div.cdk-overlay-pane > div > div > button[aria-disabled=\"false\"]")
		selenium.while(canDownloadReport + " == 0 && " + remainingAttempts + " > 0")
		Thread.sleep(NaN);
		selenium.refresh()
		selenium.waitForPageToLoad("")
		selenium.click("css=document-setup > div > div > button:nth-of-type(3)")
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (selenium.isVisible("css=div.cdk-overlay-pane > div > div > button")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		boolean canDownloadReport = selenium.isElementPresent("css=div.cdk-overlay-pane > div > div > button[aria-disabled=\"false\"]")
		String remainingAttempts = selenium.getEval("remainingAttempts - 1")
		selenium.endWhile()
		selenium.click("css=div.cdk-overlay-pane > div > div > button[aria-disabled=\"false\"]")
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (selenium.isVisible("css=snack-bar-container > simple-snack-bar")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		selenium.endIf()
		// Both
		selenium.open("https://${currentEnvironment}${tiret}${currentWebsite}/${page}")
		Thread.sleep(2000);
		selenium.click("css=button[id=\"button-new-report\"]")
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (selenium.isVisible("css=button[id=\"button-new-basic-report\"]")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		selenium.click("css=button[id=\"button-new-basic-report\"]")
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (selenium.isVisible("css=div > mat-dialog-container")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		selenium.click("css=mat-dialog-content div.mat-form-field-flex > div > mat-select")
		Thread.sleep(500);
		selenium.click("css=div[class=\"cdk-overlay-pane\"] > div > mat-option:nth-child(1)")
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (selenium.isVisible("css=div.mat-form-field-infix > input.mat-input-element")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		selenium.type("css=div.mat-form-field-infix > input.mat-input-element", "Test auto - Report - CSV Settings Daily Both")
		selenium.click("css=app-new-document-dialog > form > mat-dialog-actions > button.mat-raised-button.mat-accent > span")
		Thread.sleep(1000);
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (selenium.isVisible("css=span.no-source")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		selenium.click("css=subreport > div > header > div > button > span > i")
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (selenium.isVisible("css=div.mat-menu-content > button:nth-child(1)")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		selenium.click("css=div.mat-menu-content > button:nth-child(1)")
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (selenium.isVisible("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > i")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		selenium.click("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > i")
		selenium.type("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > input", "Both Subreport")
		selenium.fireEvent("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > input", "blur")
		selenium.click("css=document-setup > mat-card > mat-card-content > div.option.schedule > button")
		selenium.click("css=sat-datepicker-toggle > button")
		selenium.click("css=.mat-calendar-body-today")
		selenium.click("css=.mat-calendar-body-today")
		selenium.click("css=document-scheduler > div.mat-dialog-actions > button.mat-raised-button.mat-accent")
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (!selenium.isVisible("xpath=//*[text()='No report yet']")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		selenium.type("css=document-setup > mat-card > mat-card-content > div:nth-child(3) > form > button > span > input", "${templateFullPath}")
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (selenium.isVisible("css=document-setup > mat-card > mat-card-content > div:nth-child(3) > button:nth-of-type(2)")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		selenium.click("css=document-setup > mat-card > mat-card-content > div:nth-child(3) > button:nth-of-type(2)")
		selenium.type("css=section.display-sheets > table > tbody > tr:nth-child(1) > td.mat-cell.cdk-column-xls_sheet_index.mat-column-xls_sheet_index.ng-star-inserted > input", "8")
		System.out.println("ISSUE WITH OPTION css=section.display-sheets > table > tbody > tr:nth-child(1) > td:nth-of-type(4) > mat-checkbox > label > div");
		selenium.click("css=section.display-sheets > table > tbody > tr:nth-child(1) > td:nth-of-type(5) > mat-checkbox > label > div")
		selenium.fireEvent("css= td.cdk-column-xls_sheet_index.mat-column-xls_sheet_index > input", "change")
		selenium.click("css=app-document-settings > mat-dialog-actions > button.mat-raised-button.mat-accent")
		selenium.click("css=app-document > section > subreport > div > sheet > mat-card > div > div > button > span > span")
		selenium.type("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div > div:nth-child(2) > div:nth-child(1) > input", "14")
		selenium.type("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div > div:nth-child(2) > div:nth-child(2) > input", "14")
		selenium.select("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div > div:nth-child(3) > div:nth-child(1) > select", "value=;")
		selenium.click("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div > div:nth-child(3) > div:nth-child(2) > input")
		selenium.click("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div:nth-child(2) > button")
		Thread.sleep(1500);
		selenium.refresh()
		selenium.waitForPageToLoad("")
		selenium.click("css=app-document > section > subreport > div > sheet > mat-card > div > div > button > span > span")
		selenium.type("css=input#fileUpload", "${biggerCsvFullPath}")
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (selenium.isVisible("css=div.preview-info")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		String currentDate = selenium.getEval("var today = new Date(); today.toISOString().substring(0,10);")
		verifyEquals("Cumulated CSV of 1 iterations - Total rows : 782", selenium.getText("css=div.preview-info"));
		assertEquals("Header of first CSV (containing empty lines) at line 14PlacementDateDBM Cost (Account Currency)OR-Mobile_2018-01_Sales : or_mobile_cv_acquisition-terminal _2018-01: Total ConversionsOR-Mobile_2018-01_Sales : or_mobile_cv_fidelisation-terminal_2018-01: Total ConversionsOR-Mobile_2018-01_Sales : or_mobile_cv_acquisition-forfait-multi-ligne_2018-01: Total ConversionsOR-Mobile_2018-01_Sales : or_mobile_cv_acquisition-forfait_2018-01: Total ConversionsSH-Mobile_2018-01_Sales : sh_mobile_cv_acquisition-offre-mobile_2018-01: Total ConversionsSH-Mobile_2018-01_Sales : sh_mobile_cv_acquisition-terminal _2018-01: Total ConversionsOR-FAI_2018-01_Sales : or_fai_cv_confirmation-acquisition-internet-fibre_2018-01: Total ConversionsOR-FAI_2018-01_Sales : or_fai_cv_confirmation-migration-xdsl-vers-fibre_2018-01: Total ConversionsOR-Open_2018-01_Sales : or_open_cv_acquisition-open-fibre_2018-05: Total ConversionsOR-Open_2018-01_Sales : or_open_cv_migration-open-xdsl-vers-fibre_2018-01: Total ConversionsOR-FAI_2018-01_Sales : or_fai_cv_confirmation-acquisition-internet-xdsl_2018-01: Total ConversionsOR-Open_2018-01_Sales : or_open_cv_acquisition-open-xdsl_2018-01: Total ConversionsSH-Mobile-Livebox_2018-01_Sales : sh_mobile-livebox_cv_acq-offre-convergente_2018-01: Total ConversionsSH-Box-Internet_2018-08_Sales : sh_box-internet_cv_confirmation-acquisition-internet-adsl_2018-08: Total ConversionsSH-Box-Internet_2018-08_Sales : sh_box-internet_cv_confirmation-acquisition-internet-fibre_2018-10: Total ConversionsFR Orange Internet22183140_tradelab_odr_pcc_multi-format-native1_cpm_mob_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20194.080.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_pcc_multi-format-native1_cpm_web_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20190.830.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_pcc_multi-format-native2_cpm_mob_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20195.290.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00Next line is empty22183140_tradelab_odr_pcc_multi-format-native2_cpm_web_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20194.570.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_pcc_multi-format-native3_cpm_web_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20194.620.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00Next line only separators22183140_tradelab_odr_std_120x600_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms__or-fai_kpi1-acquisition-bb19/02/20191.540.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_std_1800x1000_cpm_web_dis-eve_rtg_npa_retargeting_dbm_1st-tms__or-fai_kpi1-acquisition-bb19/02/201910.210.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_std_300x250_cpm_mob_dis-iab_rtg_npa_retargeting_dbm_1st-tms__or-fai_kpi1-acquisition-bb19/02/201927.220.000.000.000.000.000.000.000.000.000.001.000.000.000.000.00", selenium.getText("css=table.preview-table:nth-of-type(1)"));
		verifyTrue(selenium.isVisible("css=div.spliter"));
		assertEquals("FR Sosh Mobile22275335_tradelab_stvalentin_std_300x600_cpm_web_dis-iab_prosp_npa_profiling_dbm_3rd-classique_sosh_kpi4-terminaux-mobile19/02/2019162.900.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22275335_tradelab_stvalentin_std_300x600_cpm_web_dis-iab_prosp_npa_prospectionalgo_dbm_ _sosh_kpi4-terminaux-mobile_kpi4-terminaux-mobile19/02/201963.250.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00Next line is empty22330690_tradelab_terminaux_std_728x90_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201990.440.000.000.000.004.000.000.000.000.000.000.000.000.000.000.00Next line only separators22330690_tradelab_terminaux_std_300x600_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/2019130.010.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22275335_tradelab_stvalentin_std_320x50_cpm_mob_dis-iab_prosp_npa_prospectionalgo_dbm_ _sosh_kpi4-terminaux-mobile_kpi4-terminaux-mobile19/02/201930.550.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22275335_tradelab_stvalentin_std_728x90_cpm_web_dis-iab_prosp_npa_profiling_dbm_2nd-tl_sosh_kpi4-terminaux-mobile19/02/20190.620.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22275335_tradelab_stvalentin_std_728x90_cpm_web_dis-iab_prosp_npa_profiling_dbm_3rd-classique_sosh_kpi4-terminaux-mobile19/02/2019124.150.000.000.000.004.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22275335_tradelab_stvalentin_std_728x90_cpm_web_dis-iab_prosp_npa_prospectionalgo_dbm_ _sosh_kpi4-terminaux-mobile_kpi4-terminaux-mobile19/02/201942.060.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00", selenium.getText("css=table.preview-table:nth-of-type(2)"));
		selenium.if("${downloadReport} == 1")
		selenium.click("css=document-setup > div > div > button:nth-of-type(3)")
		String waitForReport = "5000"
		String remainingAttempts = "40"
		boolean canDownloadReport = selenium.isElementPresent("css=div.cdk-overlay-pane > div > div > button[aria-disabled=\"false\"]")
		selenium.while(canDownloadReport + " == 0 && " + remainingAttempts + " > 0")
		Thread.sleep(NaN);
		selenium.refresh()
		selenium.waitForPageToLoad("")
		selenium.click("css=document-setup > div > div > button:nth-of-type(3)")
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (selenium.isVisible("css=div.cdk-overlay-pane > div > div > button")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		boolean canDownloadReport = selenium.isElementPresent("css=div.cdk-overlay-pane > div > div > button[aria-disabled=\"false\"]")
		String remainingAttempts = selenium.getEval("remainingAttempts - 1")
		selenium.endWhile()
		selenium.click("css=div.cdk-overlay-pane > div > div > button[aria-disabled=\"false\"]")
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (selenium.isVisible("css=snack-bar-container > simple-snack-bar")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		selenium.endIf()
	}
	@Keyword
	public void nonCumulativeCsvWithEmptyLines () {
		// Daily - Start from row
		String page = "folders"
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (selenium.isVisible("css=button[id=\"button-new-folder\"]")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		Thread.sleep(500);
		selenium.click("css=button[id=\"button-new-folder\"]")
		selenium.type("css=div.mat-form-field-infix > input.mat-input-element", "Test auto - Folder - CSV Settings Daily")
		selenium.click("css=app-new-document-dialog > form > mat-dialog-actions > button.mat-raised-button.mat-accent > span")
		Thread.sleep(1500);
		selenium.click("css=button[id=\"button-new-report\"]")
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (selenium.isVisible("css=button[id=\"button-new-basic-report\"]")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		selenium.click("css=button[id=\"button-new-basic-report\"]")
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (selenium.isVisible("css=div > mat-dialog-container")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		selenium.click("css=mat-dialog-content div.mat-form-field-flex > div > mat-select")
		Thread.sleep(500);
		selenium.click("css=div[class=\"cdk-overlay-pane\"] > div > mat-option:nth-child(1)")
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (selenium.isVisible("css=div.mat-form-field-infix > input.mat-input-element")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		selenium.type("css=div.mat-form-field-infix > input.mat-input-element", "Test auto - Report - CSV Settings Daily Start from row")
		selenium.click("css=app-new-document-dialog > form > mat-dialog-actions > button.mat-raised-button.mat-accent > span")
		Thread.sleep(1000);
		selenium.click("css=subreport > div > header > div > button > span > i")
		selenium.click("css=div.mat-menu-content > button:nth-child(1)")
		selenium.click("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > i")
		selenium.type("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > input", "Start from row Subreport")
		selenium.fireEvent("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > input", "blur")
		selenium.click("css=document-setup > mat-card > mat-card-content > div.option.schedule > button")
		selenium.click("css=sat-datepicker-toggle > button")
		selenium.click("css=.mat-calendar-body-today")
		selenium.click("css=.mat-calendar-body-today")
		selenium.click("css=document-scheduler > div.mat-dialog-actions > button.mat-raised-button.mat-accent")
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (!selenium.isVisible("xpath=//*[text()='No report yet']")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		selenium.type("css=document-setup > mat-card > mat-card-content > div:nth-child(3) > form > button > span > input", "${templateFullPath}")
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (selenium.isVisible("css=document-setup > mat-card > mat-card-content > div:nth-child(3) > button:nth-of-type(2)")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		selenium.click("css=document-setup > mat-card > mat-card-content > div:nth-child(3) > button:nth-of-type(2)")
		selenium.type("css=section.display-sheets > table > tbody > tr:nth-child(1) > td.mat-cell.cdk-column-xls_sheet_index.mat-column-xls_sheet_index.ng-star-inserted > input", "8")
		System.out.println("ISSUE WITH OPTION css=section.display-sheets > table > tbody > tr:nth-child(1) > td:nth-of-type(4) > mat-checkbox > label > div");
		selenium.click("css=section.display-sheets > table > tbody > tr:nth-child(1) > td:nth-of-type(5) > mat-checkbox > label > div")
		selenium.fireEvent("css= td.cdk-column-xls_sheet_index.mat-column-xls_sheet_index > input", "change")
		selenium.click("css=app-document-settings > mat-dialog-actions > button.mat-raised-button.mat-accent")
		selenium.click("css=app-document > section > subreport > div > sheet > mat-card > div > div > button > span > span")
		selenium.type("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div > div:nth-child(2) > div:nth-child(1) > input", "14")
		selenium.select("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div > div:nth-child(3) > div:nth-child(1) > select", "value=;")
		selenium.click("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div:nth-child(2) > button")
		Thread.sleep(1500);
		selenium.refresh()
		selenium.waitForPageToLoad("")
		selenium.click("css=app-document > section > subreport > div > sheet > mat-card > div > div > button > span > span")
		selenium.type("css=input#fileUpload", "${biggerCsvFullPath}")
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (selenium.isVisible("css=div.preview-info")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		String currentDate = selenium.getEval("var today = new Date(); today.toISOString().substring(0,10);")
		verifyEquals("CSV of iteration " + currentDate + " - Total rows : 796", selenium.getText("css=div.preview-info"));
		assertEquals("Header of first CSV (containing empty lines) at line 14PlacementDateDBM Cost (Account Currency)OR-Mobile_2018-01_Sales : or_mobile_cv_acquisition-terminal _2018-01: Total ConversionsOR-Mobile_2018-01_Sales : or_mobile_cv_fidelisation-terminal_2018-01: Total ConversionsOR-Mobile_2018-01_Sales : or_mobile_cv_acquisition-forfait-multi-ligne_2018-01: Total ConversionsOR-Mobile_2018-01_Sales : or_mobile_cv_acquisition-forfait_2018-01: Total ConversionsSH-Mobile_2018-01_Sales : sh_mobile_cv_acquisition-offre-mobile_2018-01: Total ConversionsSH-Mobile_2018-01_Sales : sh_mobile_cv_acquisition-terminal _2018-01: Total ConversionsOR-FAI_2018-01_Sales : or_fai_cv_confirmation-acquisition-internet-fibre_2018-01: Total ConversionsOR-FAI_2018-01_Sales : or_fai_cv_confirmation-migration-xdsl-vers-fibre_2018-01: Total ConversionsOR-Open_2018-01_Sales : or_open_cv_acquisition-open-fibre_2018-05: Total ConversionsOR-Open_2018-01_Sales : or_open_cv_migration-open-xdsl-vers-fibre_2018-01: Total ConversionsOR-FAI_2018-01_Sales : or_fai_cv_confirmation-acquisition-internet-xdsl_2018-01: Total ConversionsOR-Open_2018-01_Sales : or_open_cv_acquisition-open-xdsl_2018-01: Total ConversionsSH-Mobile-Livebox_2018-01_Sales : sh_mobile-livebox_cv_acq-offre-convergente_2018-01: Total ConversionsSH-Box-Internet_2018-08_Sales : sh_box-internet_cv_confirmation-acquisition-internet-adsl_2018-08: Total ConversionsSH-Box-Internet_2018-08_Sales : sh_box-internet_cv_confirmation-acquisition-internet-fibre_2018-10: Total ConversionsFR Orange Internet22183140_tradelab_odr_pcc_multi-format-native1_cpm_mob_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20194.080.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_pcc_multi-format-native1_cpm_web_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20190.830.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_pcc_multi-format-native2_cpm_mob_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20195.290.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00Next line is empty22183140_tradelab_odr_pcc_multi-format-native2_cpm_web_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20194.570.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_pcc_multi-format-native3_cpm_web_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20194.620.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00Next line only separators22183140_tradelab_odr_std_120x600_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms__or-fai_kpi1-acquisition-bb19/02/20191.540.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_std_1800x1000_cpm_web_dis-eve_rtg_npa_retargeting_dbm_1st-tms__or-fai_kpi1-acquisition-bb19/02/201910.210.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_std_300x250_cpm_mob_dis-iab_rtg_npa_retargeting_dbm_1st-tms__or-fai_kpi1-acquisition-bb19/02/201927.220.000.000.000.000.000.000.000.000.000.001.000.000.000.000.00", selenium.getText("css=table.preview-table:nth-of-type(1)"));
		verifyTrue(selenium.isVisible("css=div.spliter"));
		assertEquals("FR Sosh Mobile22330690_tradelab_terminaux_std_160x600_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201931.520.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_300x250_cpm_mob_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201919.710.000.000.000.000.001.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_300x250_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/2019161.630.000.000.000.004.001.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_300x50_cpm_mob_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/20199.980.000.000.000.000.000.000.000.000.000.000.000.000.001.000.00Next line only separators22330690_tradelab_terminaux_std_300x600_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/2019130.010.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_320x50_cpm_mob_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201910.450.000.000.000.000.001.000.000.000.000.000.000.000.000.001.00Next line is empty22330690_tradelab_terminaux_std_728x90_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201990.440.000.000.000.004.000.000.000.000.000.000.000.000.000.000.00Last line of the first CSV (containing empty lines)------13367.257.0029.008.0013.0051.0014.003.001.001.000.008.000.000.0011.009.00", selenium.getText("css=table.preview-table:nth-of-type(2)"));
		selenium.if("${downloadReport} == 1")
		selenium.click("css=document-setup > div > div > button:nth-of-type(3)")
		String waitForReport = "5000"
		String remainingAttempts = "40"
		boolean canDownloadReport = selenium.isElementPresent("css=div.cdk-overlay-pane > div > div > button[aria-disabled=\"false\"]")
		selenium.while(canDownloadReport + " == 0 && " + remainingAttempts + " > 0")
		Thread.sleep(NaN);
		selenium.refresh()
		selenium.waitForPageToLoad("")
		selenium.click("css=document-setup > div > div > button:nth-of-type(3)")
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (selenium.isVisible("css=div.cdk-overlay-pane > div > div > button")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		boolean canDownloadReport = selenium.isElementPresent("css=div.cdk-overlay-pane > div > div > button[aria-disabled=\"false\"]")
		String remainingAttempts = selenium.getEval("remainingAttempts - 1")
		selenium.endWhile()
		selenium.click("css=div.cdk-overlay-pane > div > div > button[aria-disabled=\"false\"]")
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (selenium.isVisible("css=snack-bar-container > simple-snack-bar")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		selenium.endIf()
		// Daily - Exclude last
		selenium.open("https://${currentEnvironment}${tiret}${currentWebsite}/${page}")
		Thread.sleep(2000);
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (selenium.isVisible("css=button[id=\"button-new-report\"]")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		selenium.click("css=button[id=\"button-new-report\"]")
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (selenium.isVisible("css=button[id=\"button-new-basic-report\"]")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		selenium.click("css=button[id=\"button-new-basic-report\"]")
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (selenium.isVisible("css=div > mat-dialog-container")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		selenium.click("css=mat-dialog-content div.mat-form-field-flex > div > mat-select")
		Thread.sleep(500);
		selenium.click("css=div[class=\"cdk-overlay-pane\"] > div > mat-option:nth-child(1)")
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (selenium.isVisible("css=div.mat-form-field-infix > input.mat-input-element")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		selenium.type("css=div.mat-form-field-infix > input.mat-input-element", "Test auto - Report - CSV Settings Daily Exclude last")
		selenium.click("css=app-new-document-dialog > form > mat-dialog-actions > button.mat-raised-button.mat-accent > span")
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (selenium.isVisible("css=span.no-source")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		selenium.click("css=subreport > div > header > div > button > span > i")
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (selenium.isVisible("css=div.mat-menu-content > button:nth-child(1)")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		selenium.click("css=div.mat-menu-content > button:nth-child(1)")
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (selenium.isVisible("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > i")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		selenium.click("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > i")
		selenium.type("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > input", "Exclude last Subreport")
		selenium.fireEvent("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > input", "blur")
		selenium.click("css=document-setup > mat-card > mat-card-content > div.option.schedule > button")
		selenium.click("css=sat-datepicker-toggle > button")
		selenium.click("css=.mat-calendar-body-today")
		selenium.click("css=.mat-calendar-body-today")
		selenium.click("css=document-scheduler > div.mat-dialog-actions > button.mat-raised-button.mat-accent")
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (!selenium.isVisible("xpath=//*[text()='No report yet']")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		selenium.type("css=document-setup > mat-card > mat-card-content > div:nth-child(3) > form > button > span > input", "${templateFullPath}")
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (selenium.isVisible("css=document-setup > mat-card > mat-card-content > div:nth-child(3) > button:nth-of-type(2)")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		selenium.click("css=document-setup > mat-card > mat-card-content > div:nth-child(3) > button:nth-of-type(2)")
		selenium.type("css=section.display-sheets > table > tbody > tr:nth-child(1) > td.mat-cell.cdk-column-xls_sheet_index.mat-column-xls_sheet_index.ng-star-inserted > input", "8")
		System.out.println("ISSUE WITH OPTION css=section.display-sheets > table > tbody > tr:nth-child(1) > td:nth-of-type(4) > mat-checkbox > label > div");
		selenium.click("css=section.display-sheets > table > tbody > tr:nth-child(1) > td:nth-of-type(5) > mat-checkbox > label > div")
		selenium.fireEvent("css= td.cdk-column-xls_sheet_index.mat-column-xls_sheet_index > input", "change")
		selenium.click("css=app-document-settings > mat-dialog-actions > button.mat-raised-button.mat-accent")
		selenium.click("css=app-document > section > subreport > div > sheet > mat-card > div > div > button > span > span")
		selenium.type("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div > div:nth-child(2) > div:nth-child(2) > input", "14")
		selenium.select("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div > div:nth-child(3) > div:nth-child(1) > select", "value=;")
		selenium.click("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div:nth-child(2) > button")
		Thread.sleep(1500);
		selenium.refresh()
		selenium.waitForPageToLoad("")
		selenium.click("css=app-document > section > subreport > div > sheet > mat-card > div > div > button > span > span")
		selenium.type("css=input#fileUpload", "${biggerCsvFullPath}")
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (selenium.isVisible("css=div.preview-info")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		String currentDate = selenium.getEval("var today = new Date(); today.toISOString().substring(0,10);")
		verifyEquals("CSV of iteration " + currentDate + " - Total rows : 795", selenium.getText("css=div.preview-info"));
		assertEquals("First line of first CSV (containing empty lines)Next line is empty2/20/19 4:39 AMReport Time ZoneEurope/ParisAccount ID743372Date Range2/19/19 - 2/19/19AdvertiserEquals:FR Orange Internet (8364571)AdvertiserEquals:FR Orange Mobile (8365738)Next line only separatorsEquals:FR Sosh Mobile (8364118)AdvertiserEquals:FR Sosh Internet (8364841)", selenium.getText("css=table.preview-table:nth-of-type(1)"));
		verifyTrue(selenium.isVisible("css=div.spliter"));
		assertEquals("FR Sosh Mobile22275335_tradelab_stvalentin_std_300x600_cpm_web_dis-iab_prosp_npa_profiling_dbm_3rd-classique_sosh_kpi4-terminaux-mobile19/02/2019162.900.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22275335_tradelab_stvalentin_std_300x600_cpm_web_dis-iab_prosp_npa_prospectionalgo_dbm_ _sosh_kpi4-terminaux-mobile_kpi4-terminaux-mobile19/02/201963.250.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00Next line is empty22330690_tradelab_terminaux_std_728x90_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201990.440.000.000.000.004.000.000.000.000.000.000.000.000.000.000.00Next line only separators22330690_tradelab_terminaux_std_300x600_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/2019130.010.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22275335_tradelab_stvalentin_std_320x50_cpm_mob_dis-iab_prosp_npa_prospectionalgo_dbm_ _sosh_kpi4-terminaux-mobile_kpi4-terminaux-mobile19/02/201930.550.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22275335_tradelab_stvalentin_std_728x90_cpm_web_dis-iab_prosp_npa_profiling_dbm_2nd-tl_sosh_kpi4-terminaux-mobile19/02/20190.620.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22275335_tradelab_stvalentin_std_728x90_cpm_web_dis-iab_prosp_npa_profiling_dbm_3rd-classique_sosh_kpi4-terminaux-mobile19/02/2019124.150.000.000.000.004.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22275335_tradelab_stvalentin_std_728x90_cpm_web_dis-iab_prosp_npa_prospectionalgo_dbm_ _sosh_kpi4-terminaux-mobile_kpi4-terminaux-mobile19/02/201942.060.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00", selenium.getText("css=table.preview-table:nth-of-type(2)"));
		selenium.if("${downloadReport} == 1")
		selenium.click("css=document-setup > div > div > button:nth-of-type(3)")
		String waitForReport = "5000"
		String remainingAttempts = "40"
		boolean canDownloadReport = selenium.isElementPresent("css=div.cdk-overlay-pane > div > div > button[aria-disabled=\"false\"]")
		selenium.while(canDownloadReport + " == 0 && " + remainingAttempts + " > 0")
		Thread.sleep(NaN);
		selenium.refresh()
		selenium.waitForPageToLoad("")
		selenium.click("css=document-setup > div > div > button:nth-of-type(3)")
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (selenium.isVisible("css=div.cdk-overlay-pane > div > div > button")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		boolean canDownloadReport = selenium.isElementPresent("css=div.cdk-overlay-pane > div > div > button[aria-disabled=\"false\"]")
		String remainingAttempts = selenium.getEval("remainingAttempts - 1")
		selenium.endWhile()
		selenium.click("css=div.cdk-overlay-pane > div > div > button[aria-disabled=\"false\"]")
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (selenium.isVisible("css=snack-bar-container > simple-snack-bar")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		selenium.endIf()
		// Both
		selenium.open("https://${currentEnvironment}${tiret}${currentWebsite}/${page}")
		Thread.sleep(2000);
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (selenium.isVisible("css=button[id=\"button-new-report\"]")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		selenium.click("css=button[id=\"button-new-report\"]")
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (selenium.isVisible("css=button[id=\"button-new-basic-report\"]")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		selenium.click("css=button[id=\"button-new-basic-report\"]")
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (selenium.isVisible("css=div > mat-dialog-container")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		selenium.click("css=mat-dialog-content div.mat-form-field-flex > div > mat-select")
		Thread.sleep(500);
		selenium.click("css=div[class=\"cdk-overlay-pane\"] > div > mat-option:nth-child(1)")
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (selenium.isVisible("css=div.mat-form-field-infix > input.mat-input-element")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		selenium.type("css=div.mat-form-field-infix > input.mat-input-element", "Test auto - Report - CSV Settings Daily Both")
		selenium.click("css=app-new-document-dialog > form > mat-dialog-actions > button.mat-raised-button.mat-accent > span")
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (selenium.isVisible("css=span.no-source")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		selenium.click("css=subreport > div > header > div > button > span > i")
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (selenium.isVisible("css=div.mat-menu-content > button:nth-child(1)")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		selenium.click("css=div.mat-menu-content > button:nth-child(1)")
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (selenium.isVisible("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > i")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		selenium.click("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > i")
		selenium.type("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > input", "Both Subreport")
		selenium.fireEvent("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > input", "blur")
		selenium.click("css=document-setup > mat-card > mat-card-content > div.option.schedule > button")
		selenium.click("css=sat-datepicker-toggle > button")
		selenium.click("css=.mat-calendar-body-today")
		selenium.click("css=.mat-calendar-body-today")
		selenium.click("css=document-scheduler > div.mat-dialog-actions > button.mat-raised-button.mat-accent")
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (!selenium.isVisible("xpath=//*[text()='No report yet']")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		selenium.type("css=document-setup > mat-card > mat-card-content > div:nth-child(3) > form > button > span > input", "${templateFullPath}")
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (selenium.isVisible("css=document-setup > mat-card > mat-card-content > div:nth-child(3) > button:nth-of-type(2)")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		selenium.click("css=document-setup > mat-card > mat-card-content > div:nth-child(3) > button:nth-of-type(2)")
		selenium.type("css=section.display-sheets > table > tbody > tr:nth-child(1) > td.mat-cell.cdk-column-xls_sheet_index.mat-column-xls_sheet_index.ng-star-inserted > input", "8")
		System.out.println("ISSUE WITH OPTION css=section.display-sheets > table > tbody > tr:nth-child(1) > td:nth-of-type(4) > mat-checkbox > label > div");
		selenium.click("css=section.display-sheets > table > tbody > tr:nth-child(1) > td:nth-of-type(5) > mat-checkbox > label > div")
		selenium.fireEvent("css= td.cdk-column-xls_sheet_index.mat-column-xls_sheet_index > input", "change")
		selenium.click("css=app-document-settings > mat-dialog-actions > button.mat-raised-button.mat-accent")
		selenium.click("css=app-document > section > subreport > div > sheet > mat-card > div > div > button > span > span")
		selenium.type("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div > div:nth-child(2) > div:nth-child(1) > input", "14")
		selenium.type("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div > div:nth-child(2) > div:nth-child(2) > input", "14")
		selenium.select("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div > div:nth-child(3) > div:nth-child(1) > select", "value=;")
		selenium.click("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div:nth-child(2) > button")
		Thread.sleep(1500);
		selenium.refresh()
		selenium.waitForPageToLoad("")
		selenium.click("css=app-document > section > subreport > div > sheet > mat-card > div > div > button > span > span")
		selenium.type("css=input#fileUpload", "${biggerCsvFullPath}")
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (selenium.isVisible("css=div.preview-info")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		String currentDate = selenium.getEval("var today = new Date(); today.toISOString().substring(0,10);")
		verifyEquals("CSV of iteration " + currentDate + " - Total rows : 782", selenium.getText("css=div.preview-info"));
		assertEquals("Header of first CSV (containing empty lines) at line 14PlacementDateDBM Cost (Account Currency)OR-Mobile_2018-01_Sales : or_mobile_cv_acquisition-terminal _2018-01: Total ConversionsOR-Mobile_2018-01_Sales : or_mobile_cv_fidelisation-terminal_2018-01: Total ConversionsOR-Mobile_2018-01_Sales : or_mobile_cv_acquisition-forfait-multi-ligne_2018-01: Total ConversionsOR-Mobile_2018-01_Sales : or_mobile_cv_acquisition-forfait_2018-01: Total ConversionsSH-Mobile_2018-01_Sales : sh_mobile_cv_acquisition-offre-mobile_2018-01: Total ConversionsSH-Mobile_2018-01_Sales : sh_mobile_cv_acquisition-terminal _2018-01: Total ConversionsOR-FAI_2018-01_Sales : or_fai_cv_confirmation-acquisition-internet-fibre_2018-01: Total ConversionsOR-FAI_2018-01_Sales : or_fai_cv_confirmation-migration-xdsl-vers-fibre_2018-01: Total ConversionsOR-Open_2018-01_Sales : or_open_cv_acquisition-open-fibre_2018-05: Total ConversionsOR-Open_2018-01_Sales : or_open_cv_migration-open-xdsl-vers-fibre_2018-01: Total ConversionsOR-FAI_2018-01_Sales : or_fai_cv_confirmation-acquisition-internet-xdsl_2018-01: Total ConversionsOR-Open_2018-01_Sales : or_open_cv_acquisition-open-xdsl_2018-01: Total ConversionsSH-Mobile-Livebox_2018-01_Sales : sh_mobile-livebox_cv_acq-offre-convergente_2018-01: Total ConversionsSH-Box-Internet_2018-08_Sales : sh_box-internet_cv_confirmation-acquisition-internet-adsl_2018-08: Total ConversionsSH-Box-Internet_2018-08_Sales : sh_box-internet_cv_confirmation-acquisition-internet-fibre_2018-10: Total ConversionsFR Orange Internet22183140_tradelab_odr_pcc_multi-format-native1_cpm_mob_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20194.080.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_pcc_multi-format-native1_cpm_web_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20190.830.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_pcc_multi-format-native2_cpm_mob_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20195.290.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00Next line is empty22183140_tradelab_odr_pcc_multi-format-native2_cpm_web_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20194.570.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_pcc_multi-format-native3_cpm_web_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20194.620.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00Next line only separators22183140_tradelab_odr_std_120x600_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms__or-fai_kpi1-acquisition-bb19/02/20191.540.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_std_1800x1000_cpm_web_dis-eve_rtg_npa_retargeting_dbm_1st-tms__or-fai_kpi1-acquisition-bb19/02/201910.210.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_std_300x250_cpm_mob_dis-iab_rtg_npa_retargeting_dbm_1st-tms__or-fai_kpi1-acquisition-bb19/02/201927.220.000.000.000.000.000.000.000.000.000.001.000.000.000.000.00", selenium.getText("css=table.preview-table:nth-of-type(1)"));
		verifyTrue(selenium.isVisible("css=div.spliter"));
		verifyEquals("FR Sosh Mobile22275335_tradelab_stvalentin_std_300x600_cpm_web_dis-iab_prosp_npa_profiling_dbm_3rd-classique_sosh_kpi4-terminaux-mobile19/02/2019162.900.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22275335_tradelab_stvalentin_std_300x600_cpm_web_dis-iab_prosp_npa_prospectionalgo_dbm_ _sosh_kpi4-terminaux-mobile_kpi4-terminaux-mobile19/02/201963.250.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00Next line is empty22330690_tradelab_terminaux_std_728x90_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201990.440.000.000.000.004.000.000.000.000.000.000.000.000.000.000.00Next line only separators22330690_tradelab_terminaux_std_300x600_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/2019130.010.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22275335_tradelab_stvalentin_std_320x50_cpm_mob_dis-iab_prosp_npa_prospectionalgo_dbm_ _sosh_kpi4-terminaux-mobile_kpi4-terminaux-mobile19/02/201930.550.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22275335_tradelab_stvalentin_std_728x90_cpm_web_dis-iab_prosp_npa_profiling_dbm_2nd-tl_sosh_kpi4-terminaux-mobile19/02/20190.620.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22275335_tradelab_stvalentin_std_728x90_cpm_web_dis-iab_prosp_npa_profiling_dbm_3rd-classique_sosh_kpi4-terminaux-mobile19/02/2019124.150.000.000.000.004.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22275335_tradelab_stvalentin_std_728x90_cpm_web_dis-iab_prosp_npa_prospectionalgo_dbm_ _sosh_kpi4-terminaux-mobile_kpi4-terminaux-mobile19/02/201942.060.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00", selenium.getText("css=table.preview-table:nth-of-type(2)"));
		selenium.if("${downloadReport} == 1")
		selenium.click("css=document-setup > div > div > button:nth-of-type(3)")
		String waitForReport = "5000"
		String remainingAttempts = "40"
		boolean canDownloadReport = selenium.isElementPresent("css=div.cdk-overlay-pane > div > div > button[aria-disabled=\"false\"]")
		selenium.while(canDownloadReport + " == 0 && " + remainingAttempts + " > 0")
		Thread.sleep(NaN);
		selenium.refresh()
		selenium.waitForPageToLoad("")
		selenium.click("css=document-setup > div > div > button:nth-of-type(3)")
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (selenium.isVisible("css=div.cdk-overlay-pane > div > div > button")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		boolean canDownloadReport = selenium.isElementPresent("css=div.cdk-overlay-pane > div > div > button[aria-disabled=\"false\"]")
		String remainingAttempts = selenium.getEval("remainingAttempts - 1")
		selenium.endWhile()
		selenium.click("css=div.cdk-overlay-pane > div > div > button[aria-disabled=\"false\"]")
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (selenium.isVisible("css=snack-bar-container > simple-snack-bar")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		selenium.endIf()
	}
	@Keyword
	public void cumulativeNormalCsv () {
		// Create folder
		createFolder("Test auto - Cumulative - CSV Settings - Normal CSV")
		// Cumulative iterations - CSV < 20 rows
		String page = "folders"
		selenium.open("http://${currentEnvironment}-reportfolio-api.tradelab.fr/internals/commander/index.php")
		selenium.waitForPageToLoad("")
		assertTrue(selenium.isElementPresent("css=body > p > a > button"));
		selenium.click("css=body > p > a > button")
		selenium.waitForPageToLoad("30000")
		String currentTime = selenium.getValue("css=#delta_interval")
		selenium.if("\"" + currentTime + "\" != \"P0D\"")
		selenium.type("css=#delta_interval", "P0D")
		selenium.click("css=form > p > input[type=\"submit\"]")
		selenium.waitForPageToLoad("30000")
		selenium.endIf()
		selenium.open("https://${currentEnvironment}${tiret}${currentWebsite}/" + page)
		Thread.sleep(2000);
		selenium.click("css=button[id=\"button-new-report\"]")
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (selenium.isVisible("css=button[id=\"button-new-basic-report\"]")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		selenium.click("css=button[id=\"button-new-basic-report\"]")
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (selenium.isVisible("css=div > mat-dialog-container")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		selenium.click("css=mat-dialog-content div.mat-form-field-flex > div > mat-select")
		Thread.sleep(500);
		selenium.click("css=div[class=\"cdk-overlay-pane\"] > div > mat-option:nth-child(1)")
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (selenium.isVisible("css=div.mat-form-field-infix > input.mat-input-element")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		selenium.type("css=div.mat-form-field-infix > input.mat-input-element", "Test auto - Report - Cumulative iterations - CSV < 20 rows")
		selenium.click("css=app-new-document-dialog > form > mat-dialog-actions > button.mat-raised-button.mat-accent > span")
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (selenium.isVisible("css=app-document > section > subreport > div > header > span")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		Thread.sleep(1500);
		selenium.click("css=subreport > div > header > div > button > span > i")
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (selenium.isVisible("css=div.mat-menu-content > button:nth-child(1)")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		selenium.click("css=div.mat-menu-content > button:nth-child(1)")
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (selenium.isVisible("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > i")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		selenium.click("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > i")
		selenium.type("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > input", "Cumulative iterations - CSV < 20 rows Subreport")
		selenium.fireEvent("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > input", "blur")
		selenium.click("css=document-setup > mat-card > mat-card-content > div.option.schedule > button")
		selenium.click("css=sat-datepicker-toggle > button")
		selenium.click("css=.mat-calendar-body-today")
		selenium.click("css=.mat-calendar-body-today")
		selenium.click("css=document-scheduler > div.mat-dialog-actions > button.mat-raised-button.mat-accent")
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (!selenium.isVisible("xpath=//*[text()='No report yet']")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		selenium.type("css=document-setup > mat-card > mat-card-content > div:nth-child(3) > form > button > span > input", "${templateFullPath}")
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (selenium.isVisible("css=document-setup > mat-card > mat-card-content > div:nth-child(3) > button:nth-of-type(2)")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		selenium.click("css=document-setup > mat-card > mat-card-content > div:nth-child(3) > button:nth-of-type(2)")
		selenium.type("css=section.display-sheets > table > tbody > tr:nth-child(1) > td.mat-cell.cdk-column-xls_sheet_index.mat-column-xls_sheet_index.ng-star-inserted > input", "8")
		System.out.println("ISSUE WITH OPTION css=section.display-sheets > table > tbody > tr:nth-child(1) > td:nth-of-type(4) > mat-checkbox > label > div");
		selenium.click("css=section.display-sheets > table > tbody > tr:nth-child(1) > td:nth-of-type(5) > mat-checkbox > label > div")
		selenium.fireEvent("css= td.cdk-column-xls_sheet_index.mat-column-xls_sheet_index > input", "change")
		selenium.click("css=app-document-settings > mat-dialog-actions > button.mat-raised-button.mat-accent")
		selenium.click("css=app-document > section > subreport > div > sheet > mat-card > div > div > button > span > span")
		selenium.type("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div > div:nth-child(2) > div:nth-child(1) > input", "1")
		selenium.type("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div > div:nth-child(2) > div:nth-child(2) > input", "0")
		selenium.select("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div > div:nth-child(3) > div:nth-child(1) > select", "value=;")
		selenium.click("css=#cumulative")
		selenium.click("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div:nth-child(2) > button")
		Thread.sleep(1500);
		selenium.refresh()
		selenium.waitForPageToLoad("")
		selenium.click("css=app-document > section > subreport > div > sheet > mat-card > div > div > button > span > span")
		selenium.type("css=input#fileUpload", "${smallerCsvFullPath}")
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (selenium.isVisible("css=div.preview-info")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		String currentDate = selenium.getEval("var today = new Date(); today.toISOString().substring(0,10);")
		verifyEquals("Cumulated CSV of 1 iterations - Total rows : 7", selenium.getText("css=div.preview-info"));
		assertEquals("First line of first CSVPlacementDateDBM Cost (Account Currency)OR-Mobile_2018-01_Sales : or_mobile_cv_acquisition-terminal _2018-01: Total ConversionsOR-Mobile_2018-01_Sales : or_mobile_cv_fidelisation-terminal_2018-01: Total ConversionsOR-Mobile_2018-01_Sales : or_mobile_cv_acquisition-forfait-multi-ligne_2018-01: Total ConversionsOR-Mobile_2018-01_Sales : or_mobile_cv_acquisition-forfait_2018-01: Total ConversionsSH-Mobile_2018-01_Sales : sh_mobile_cv_acquisition-offre-mobile_2018-01: Total ConversionsSH-Mobile_2018-01_Sales : sh_mobile_cv_acquisition-terminal _2018-01: Total ConversionsOR-FAI_2018-01_Sales : or_fai_cv_confirmation-acquisition-internet-fibre_2018-01: Total ConversionsOR-FAI_2018-01_Sales : or_fai_cv_confirmation-migration-xdsl-vers-fibre_2018-01: Total ConversionsOR-Open_2018-01_Sales : or_open_cv_acquisition-open-fibre_2018-05: Total ConversionsOR-Open_2018-01_Sales : or_open_cv_migration-open-xdsl-vers-fibre_2018-01: Total ConversionsOR-FAI_2018-01_Sales : or_fai_cv_confirmation-acquisition-internet-xdsl_2018-01: Total ConversionsOR-Open_2018-01_Sales : or_open_cv_acquisition-open-xdsl_2018-01: Total ConversionsSH-Mobile-Livebox_2018-01_Sales : sh_mobile-livebox_cv_acq-offre-convergente_2018-01: Total ConversionsSH-Box-Internet_2018-08_Sales : sh_box-internet_cv_confirmation-acquisition-internet-adsl_2018-08: Total ConversionsSH-Box-Internet_2018-08_Sales : sh_box-internet_cv_confirmation-acquisition-internet-fibre_2018-10: Total ConversionsFR Orange Internet22183140_tradelab_odr_pcc_multi-format-native1_cpm_mob_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20194.080.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_pcc_multi-format-native2_cpm_web_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20194.570.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_pcc_multi-format-native3_cpm_mob_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20194.480.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_320x480_cpm_mob_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/20192.280.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_728x90_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201990.440.000.000.000.004.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_970x250_cpm_web_dis-eve_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201912.950.000.000.000.000.001.000.000.000.000.000.000.000.000.000.00Last line of first CSV------13367.257.0029.008.0013.0051.0014.003.001.001.000.008.000.000.0011.009.00", selenium.getText("css=table.preview-table:nth-of-type(1)"));
		String currentReportUrl = selenium.getEval("document.location.href")
		selenium.open("http://${currentEnvironment}-reportfolio-api.tradelab.fr/internals/commander/index.php")
		selenium.waitForPageToLoad("")
		assertTrue(selenium.isElementPresent("css=body > p > a > button"));
		selenium.click("css=body > p > a > button")
		selenium.waitForPageToLoad("30000")
		String currentTime = selenium.getValue("css=#delta_interval")
		selenium.type("css=#delta_interval", "P1D")
		selenium.click("css=form > p > input[type=\"submit\"]")
		selenium.waitForPageToLoad("30000")
		Thread.sleep(3000);
		selenium.open(currentReportUrl)
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (selenium.isVisible("css=div.option.schedule > label > i")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		selenium.click("css=div.option.schedule > label > i")
		for (int second = 0;; second++) {
			if (second >= 60) fail("timeout");
			try { if (!selenium.isVisible("css=div.option.schedule > button:nth-of-type(2)")) break; } catch (Exception e) {}
			Thread.sleep(1000);
		}
		selenium.click("css=document-setup > mat-card > mat-card-content > div.option.schedule > button")
		selenium.click("css=sat-datepicker-toggle > button")
		String tomorrow = selenium.getEval("const date = new Date(); date.setDate(date.getDate() + 1); const options = { year: 'numeric', month: 'long', day: 'numeric' }; new Intl.DateTimeFormat('en-US', options).format(date)")
		String tomorrowNumeric = selenium.getEval("const date = new Date(); date.setDate(date.getDate() + 1); const options = { year: 'numeric', month: 'numeric', day: 'numeric' }; new Intl.DateTimeFormat('fr-FR', options).format(date).replace(/(\\d+)\\/(\\d+)\\/(\\d+)/, '$3-$2-$1')")
	 selenium.click("css=[aria-label=\"" + tomorrow + "\"]")
	 selenium.click("css=[aria-label=\"" + tomorrow + "\"]")
	 selenium.click("css=document-scheduler > div.mat-dialog-actions > button.mat-raised-button.mat-accent")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("xpath=//*[text()='Report " + tomorrowNumeric + "']")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.type("css=input#fileUpload", "${smallerCsvTwoFullPath}")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div.preview-info")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 String currentDate = selenium.getEval("var today = new Date(); today.toISOString().substring(0,10);")
	 verifyEquals("Cumulated CSV of 2 iterations - Total rows : 14", selenium.getText("css=div.preview-info"));
	 assertEquals("First line of first CSVPlacementDateDBM Cost (Account Currency)OR-Mobile_2018-01_Sales : or_mobile_cv_acquisition-terminal _2018-01: Total ConversionsOR-Mobile_2018-01_Sales : or_mobile_cv_fidelisation-terminal_2018-01: Total ConversionsOR-Mobile_2018-01_Sales : or_mobile_cv_acquisition-forfait-multi-ligne_2018-01: Total ConversionsOR-Mobile_2018-01_Sales : or_mobile_cv_acquisition-forfait_2018-01: Total ConversionsSH-Mobile_2018-01_Sales : sh_mobile_cv_acquisition-offre-mobile_2018-01: Total ConversionsSH-Mobile_2018-01_Sales : sh_mobile_cv_acquisition-terminal _2018-01: Total ConversionsOR-FAI_2018-01_Sales : or_fai_cv_confirmation-acquisition-internet-fibre_2018-01: Total ConversionsOR-FAI_2018-01_Sales : or_fai_cv_confirmation-migration-xdsl-vers-fibre_2018-01: Total ConversionsOR-Open_2018-01_Sales : or_open_cv_acquisition-open-fibre_2018-05: Total ConversionsOR-Open_2018-01_Sales : or_open_cv_migration-open-xdsl-vers-fibre_2018-01: Total ConversionsOR-FAI_2018-01_Sales : or_fai_cv_confirmation-acquisition-internet-xdsl_2018-01: Total ConversionsOR-Open_2018-01_Sales : or_open_cv_acquisition-open-xdsl_2018-01: Total ConversionsSH-Mobile-Livebox_2018-01_Sales : sh_mobile-livebox_cv_acq-offre-convergente_2018-01: Total ConversionsSH-Box-Internet_2018-08_Sales : sh_box-internet_cv_confirmation-acquisition-internet-adsl_2018-08: Total ConversionsSH-Box-Internet_2018-08_Sales : sh_box-internet_cv_confirmation-acquisition-internet-fibre_2018-10: Total ConversionsFR Orange Internet22183140_tradelab_odr_pcc_multi-format-native1_cpm_mob_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20194.080.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_pcc_multi-format-native2_cpm_web_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20194.570.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_pcc_multi-format-native3_cpm_mob_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20194.480.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_320x480_cpm_mob_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/20192.280.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_728x90_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201990.440.000.000.000.004.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_970x250_cpm_web_dis-eve_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201912.950.000.000.000.000.001.000.000.000.000.000.000.000.000.000.00Last line of first CSV------13367.257.0029.008.0013.0051.0014.003.001.001.000.008.000.000.0011.009.00FR Orange Internet22183140_tradelab_odr_pcc_multi-format-native1_cpm_mob_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20194.080.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_pcc_multi-format-native2_cpm_web_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20194.570.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_pcc_multi-format-native3_cpm_mob_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20194.480.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_320x480_cpm_mob_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/20192.280.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_728x90_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201990.440.000.000.000.004.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_970x250_cpm_web_dis-eve_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201912.950.000.000.000.000.001.000.000.000.000.000.000.000.000.000.00Last line of second CSV------13367.257.0029.008.0013.0051.0014.003.001.001.000.008.000.000.0011.009.00", selenium.getText("css=table.preview-table:nth-of-type(1)"));
	 selenium.click("css=document-setup > div > div > button:nth-of-type(3)")
	 selenium.if("${downloadReport} == 1")
	 String waitForReport = "5000"
	 String remainingAttempts = "40"
	 boolean canDownloadReport = selenium.isElementPresent("css=div.cdk-overlay-pane > div > div > button[aria-disabled=\"false\"]")
	 selenium.while(canDownloadReport + " == 0 && " + remainingAttempts + " > 0")
	 Thread.sleep(NaN);
	 selenium.refresh()
	 selenium.waitForPageToLoad("")
	 selenium.click("css=document-setup > div > div > button:nth-of-type(3)")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div.cdk-overlay-pane > div > div > button")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 boolean canDownloadReport = selenium.isElementPresent("css=div.cdk-overlay-pane > div > div > button[aria-disabled=\"false\"]")
	 String remainingAttempts = selenium.getEval("remainingAttempts - 1")
	 selenium.endWhile()
	 selenium.click("css=div.cdk-overlay-pane > div > div > button[aria-disabled=\"false\"]")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=snack-bar-container > simple-snack-bar")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.endIf()
	 selenium.open("http://${currentEnvironment}-reportfolio-api.tradelab.fr/internals/commander/index.php")
	 selenium.waitForPageToLoad("")
	 assertTrue(selenium.isElementPresent("css=body > p > a > button"));
	 selenium.click("css=body > p > a > button")
	 selenium.waitForPageToLoad("30000")
	 String currentTime = selenium.getValue("css=#delta_interval")
	 selenium.if("\"" + currentTime + "\" != \"P0D\"")
	 selenium.type("css=#delta_interval", "P0D")
	 selenium.click("css=form > p > input[type=\"submit\"]")
	 selenium.waitForPageToLoad("30000")
	 selenium.endIf()
	 selenium.open(currentReportUrl)
	 // Cumulative iterations - CSV > 20 rows
	 String page = "folders"
	 selenium.open("http://${currentEnvironment}-reportfolio-api.tradelab.fr/internals/commander/index.php")
	 selenium.waitForPageToLoad("")
	 assertTrue(selenium.isElementPresent("css=body > p > a > button"));
	 selenium.click("css=body > p > a > button")
	 selenium.waitForPageToLoad("30000")
	 String currentTime = selenium.getValue("css=#delta_interval")
	 selenium.if("\"" + currentTime + "\" != \"P0D\"")
	 selenium.type("css=#delta_interval", "P0D")
	 selenium.click("css=form > p > input[type=\"submit\"]")
	 selenium.waitForPageToLoad("30000")
	 selenium.endIf()
	 selenium.open("https://${currentEnvironment}${tiret}${currentWebsite}/" + page)
	 Thread.sleep(2000);
	 selenium.click("css=button[id=\"button-new-report\"]")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=button[id=\"button-new-basic-report\"]")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=button[id=\"button-new-basic-report\"]")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div > mat-dialog-container")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=mat-dialog-content div.mat-form-field-flex > div > mat-select")
	 Thread.sleep(500);
	 selenium.click("css=div[class=\"cdk-overlay-pane\"] > div > mat-option:nth-child(1)")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div.mat-form-field-infix > input.mat-input-element")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.type("css=div.mat-form-field-infix > input.mat-input-element", "Test auto - Report - Cumulative iterations - CSV > 20 rows")
	 selenium.click("css=app-new-document-dialog > form > mat-dialog-actions > button.mat-raised-button.mat-accent > span")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=app-document > section > subreport > div > header > span")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 Thread.sleep(1500);
	 selenium.click("css=subreport > div > header > div > button > span > i")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div.mat-menu-content > button:nth-child(1)")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=div.mat-menu-content > button:nth-child(1)")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > i")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > i")
	 selenium.type("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > input", "Cumulative iterations - CSV > 20 rows Subreport")
	 selenium.fireEvent("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > input", "blur")
	 selenium.click("css=document-setup > mat-card > mat-card-content > div.option.schedule > button")
	 selenium.click("css=sat-datepicker-toggle > button")
	 selenium.click("css=.mat-calendar-body-today")
	 selenium.click("css=.mat-calendar-body-today")
	 selenium.click("css=document-scheduler > div.mat-dialog-actions > button.mat-raised-button.mat-accent")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (!selenium.isVisible("xpath=//*[text()='No report yet']")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.type("css=document-setup > mat-card > mat-card-content > div:nth-child(3) > form > button > span > input", "${templateFullPath}")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=document-setup > mat-card > mat-card-content > div:nth-child(3) > button:nth-of-type(2)")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=document-setup > mat-card > mat-card-content > div:nth-child(3) > button:nth-of-type(2)")
	 selenium.type("css=section.display-sheets > table > tbody > tr:nth-child(1) > td.mat-cell.cdk-column-xls_sheet_index.mat-column-xls_sheet_index.ng-star-inserted > input", "8")
	 System.out.println("ISSUE WITH OPTION css=section.display-sheets > table > tbody > tr:nth-child(1) > td:nth-of-type(4) > mat-checkbox > label > div");
	 selenium.click("css=section.display-sheets > table > tbody > tr:nth-child(1) > td:nth-of-type(5) > mat-checkbox > label > div")
	 selenium.fireEvent("css= td.cdk-column-xls_sheet_index.mat-column-xls_sheet_index > input", "change")
	 selenium.click("css=app-document-settings > mat-dialog-actions > button.mat-raised-button.mat-accent")
	 selenium.click("css=app-document > section > subreport > div > sheet > mat-card > div > div > button > span > span")
	 selenium.type("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div > div:nth-child(2) > div:nth-child(1) > input", "1")
	 selenium.type("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div > div:nth-child(2) > div:nth-child(2) > input", "0")
	 selenium.select("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div > div:nth-child(3) > div:nth-child(1) > select", "value=;")
	 selenium.click("css=#cumulative")
	 selenium.click("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div:nth-child(2) > button")
	 Thread.sleep(1500);
	 selenium.refresh()
	 selenium.waitForPageToLoad("")
	 selenium.click("css=app-document > section > subreport > div > sheet > mat-card > div > div > button > span > span")
	 selenium.type("css=input#fileUpload", "${biggerCsvFullPath}")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div.preview-info")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 String currentDate = selenium.getEval("var today = new Date(); today.toISOString().substring(0,10);")
	 verifyEquals("Cumulated CSV of 1 iterations - Total rows : 807", selenium.getText("css=div.preview-info"));
	 assertEquals("First line of first CSVDate/Time Generated2/20/19 4:39 AMReport Time ZoneEurope/ParisAccount ID743372Date Range2/19/19 - 2/19/19AdvertiserEquals:FR Orange Internet (8364571)AdvertiserEquals:FR Orange Mobile (8365738)AdvertiserEquals:FR Sosh Internet (8364841)AdvertiserEquals:FR Sosh Mobile (8364118)MRC Accredited MetricsNoneReport Fields", selenium.getText("css=table.preview-table:nth-of-type(1)"));
	 verifyTrue(selenium.isVisible("css=div.spliter"));
	 assertEquals("FR Sosh Mobile22330690_tradelab_terminaux_std_160x600_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201931.520.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_300x250_cpm_mob_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201919.710.000.000.000.000.001.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_300x250_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/2019161.630.000.000.000.004.001.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_300x50_cpm_mob_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/20199.980.000.000.000.000.000.000.000.000.000.000.000.000.001.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_300x600_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/2019130.010.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_320x480_cpm_mob_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/20192.280.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_320x50_cpm_mob_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201910.450.000.000.000.000.001.000.000.000.000.000.000.000.000.001.00FR Sosh Mobile22330690_tradelab_terminaux_std_728x90_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201990.440.000.000.000.004.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_970x250_cpm_web_dis-eve_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201912.950.000.000.000.000.001.000.000.000.000.000.000.000.000.000.00Last line of first CSV------13367.257.0029.008.0013.0051.0014.003.001.001.000.008.000.000.0011.009.00", selenium.getText("css=table.preview-table:nth-of-type(2)"));
	 String currentReportUrl = selenium.getEval("document.location.href")
	 selenium.open("http://${currentEnvironment}-reportfolio-api.tradelab.fr/internals/commander/index.php")
	 selenium.waitForPageToLoad("")
	 assertTrue(selenium.isElementPresent("css=body > p > a > button"));
	 selenium.click("css=body > p > a > button")
	 selenium.waitForPageToLoad("30000")
	 String currentTime = selenium.getValue("css=#delta_interval")
	 selenium.type("css=#delta_interval", "P1D")
	 selenium.click("css=form > p > input[type=\"submit\"]")
	 selenium.waitForPageToLoad("30000")
	 Thread.sleep(3000);
	 selenium.open(currentReportUrl)
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div.option.schedule > label > i")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=div.option.schedule > label > i")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (!selenium.isVisible("css=div.option.schedule > button:nth-of-type(2)")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=document-setup > mat-card > mat-card-content > div.option.schedule > button")
	 selenium.click("css=sat-datepicker-toggle > button")
	 String tomorrow = selenium.getEval("const date = new Date(); date.setDate(date.getDate() + 1); const options = { year: 'numeric',   month: 'long',   day: 'numeric' };  new Intl.DateTimeFormat('en-US', options).format(date)")
	 String tomorrowNumeric = selenium.getEval("const date = new Date(); date.setDate(date.getDate() + 1); const options = { year: 'numeric', month: 'numeric', day: 'numeric' }; new Intl.DateTimeFormat('fr-FR', options).format(date).replace(/(\\d+)\\/(\\d+)\\/(\\d+)/, '$3-$2-$1')")
	 selenium.click("css=[aria-label=\"" + tomorrow + "\"]")
	 selenium.click("css=[aria-label=\"" + tomorrow + "\"]")
	 selenium.click("css=document-scheduler > div.mat-dialog-actions > button.mat-raised-button.mat-accent")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("xpath=//*[text()='Report " + tomorrowNumeric + "']")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.type("css=input#fileUpload", "${biggerCsvTwoFullPath}")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div.preview-info")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 String currentDate = selenium.getEval("var today = new Date(); today.toISOString().substring(0,10);")
	 verifyEquals("Cumulated CSV of 2 iterations - Total rows : 1614", selenium.getText("css=div.preview-info"));
	 assertEquals("First line of first CSVDate/Time Generated2/20/19 4:39 AMReport Time ZoneEurope/ParisAccount ID743372Date Range2/19/19 - 2/19/19AdvertiserEquals:FR Orange Internet (8364571)AdvertiserEquals:FR Orange Mobile (8365738)AdvertiserEquals:FR Sosh Internet (8364841)AdvertiserEquals:FR Sosh Mobile (8364118)MRC Accredited MetricsNoneReport Fields", selenium.getText("css=table.preview-table:nth-of-type(1)"));
	 verifyTrue(selenium.isVisible("css=div.spliter"));
	 assertEquals("FR Sosh Mobile22330690_tradelab_terminaux_std_160x600_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201931.520.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_300x250_cpm_mob_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201919.710.000.000.000.000.001.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_300x250_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/2019161.630.000.000.000.004.001.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_300x50_cpm_mob_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/20199.980.000.000.000.000.000.000.000.000.000.000.000.000.001.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_300x600_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/2019130.010.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_320x480_cpm_mob_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/20192.280.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_320x50_cpm_mob_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201910.450.000.000.000.000.001.000.000.000.000.000.000.000.000.001.00FR Sosh Mobile22330690_tradelab_terminaux_std_728x90_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201990.440.000.000.000.004.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_970x250_cpm_web_dis-eve_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201912.950.000.000.000.000.001.000.000.000.000.000.000.000.000.000.00Last line of second CSV------13367.257.0029.008.0013.0051.0014.003.001.001.000.008.000.000.0011.009.00", selenium.getText("css=table.preview-table:nth-of-type(2)"));
	 selenium.click("css=document-setup > div > div > button:nth-of-type(3)")
	 selenium.if("${downloadReport} == 1")
	 String waitForReport = "5000"
	 String remainingAttempts = "40"
	 boolean canDownloadReport = selenium.isElementPresent("css=div.cdk-overlay-pane > div > div > button[aria-disabled=\"false\"]")
	 selenium.while(canDownloadReport + " == 0 && " + remainingAttempts + " > 0")
	 Thread.sleep(NaN);
	 selenium.refresh()
	 selenium.waitForPageToLoad("")
	 selenium.click("css=document-setup > div > div > button:nth-of-type(3)")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div.cdk-overlay-pane > div > div > button")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 boolean canDownloadReport = selenium.isElementPresent("css=div.cdk-overlay-pane > div > div > button[aria-disabled=\"false\"]")
	 String remainingAttempts = selenium.getEval("remainingAttempts - 1")
	 selenium.endWhile()
	 selenium.click("css=div.cdk-overlay-pane > div > div > button[aria-disabled=\"false\"]")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=snack-bar-container > simple-snack-bar")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.endIf()
	 selenium.open("http://${currentEnvironment}-reportfolio-api.tradelab.fr/internals/commander/index.php")
	 selenium.waitForPageToLoad("")
	 assertTrue(selenium.isElementPresent("css=body > p > a > button"));
	 selenium.click("css=body > p > a > button")
	 selenium.waitForPageToLoad("30000")
	 String currentTime = selenium.getValue("css=#delta_interval")
	 selenium.if("\"" + currentTime + "\" != \"P0D\"")
	 selenium.type("css=#delta_interval", "P0D")
	 selenium.click("css=form > p > input[type=\"submit\"]")
	 selenium.waitForPageToLoad("30000")
	 selenium.endIf()
	 selenium.open(currentReportUrl)
	 // Cumulative 3 iterations - CSV > 20 rows
	 String page = "folders"
	 selenium.open("http://${currentEnvironment}-reportfolio-api.tradelab.fr/internals/commander/index.php")
	 selenium.waitForPageToLoad("")
	 assertTrue(selenium.isElementPresent("css=body > p > a > button"));
	 selenium.click("css=body > p > a > button")
	 selenium.waitForPageToLoad("30000")
	 String currentTime = selenium.getValue("css=#delta_interval")
	 selenium.if("\"" + currentTime + "\" != \"P0D\"")
	 selenium.type("css=#delta_interval", "P0D")
	 selenium.click("css=form > p > input[type=\"submit\"]")
	 selenium.waitForPageToLoad("30000")
	 selenium.endIf()
	 selenium.open("https://${currentEnvironment}${tiret}${currentWebsite}/" + page)
	 Thread.sleep(2000);
	 selenium.click("css=button[id=\"button-new-report\"]")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=button[id=\"button-new-basic-report\"]")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=button[id=\"button-new-basic-report\"]")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div > mat-dialog-container")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=mat-dialog-content div.mat-form-field-flex > div > mat-select")
	 Thread.sleep(500);
	 selenium.click("css=div[class=\"cdk-overlay-pane\"] > div > mat-option:nth-child(1)")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div.mat-form-field-infix > input.mat-input-element")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.type("css=div.mat-form-field-infix > input.mat-input-element", "Test auto - Report - Cumulative iterations - CSV > 20 rows")
	 selenium.click("css=app-new-document-dialog > form > mat-dialog-actions > button.mat-raised-button.mat-accent > span")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=app-document > section > subreport > div > header > span")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 Thread.sleep(1500);
	 selenium.click("css=subreport > div > header > div > button > span > i")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div.mat-menu-content > button:nth-child(1)")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=div.mat-menu-content > button:nth-child(1)")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > i")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > i")
	 selenium.type("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > input", "Cumulative iterations - CSV > 20 rows Subreport")
	 selenium.fireEvent("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > input", "blur")
	 selenium.click("css=document-setup > mat-card > mat-card-content > div.option.schedule > button")
	 selenium.click("css=sat-datepicker-toggle > button")
	 selenium.click("css=.mat-calendar-body-today")
	 selenium.click("css=.mat-calendar-body-today")
	 selenium.click("css=document-scheduler > div.mat-dialog-actions > button.mat-raised-button.mat-accent")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (!selenium.isVisible("xpath=//*[text()='No report yet']")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.type("css=document-setup > mat-card > mat-card-content > div:nth-child(3) > form > button > span > input", "${templateFullPath}")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=document-setup > mat-card > mat-card-content > div:nth-child(3) > button:nth-of-type(2)")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=document-setup > mat-card > mat-card-content > div:nth-child(3) > button:nth-of-type(2)")
	 selenium.type("css=section.display-sheets > table > tbody > tr:nth-child(1) > td.mat-cell.cdk-column-xls_sheet_index.mat-column-xls_sheet_index.ng-star-inserted > input", "8")
	 System.out.println("ISSUE WITH OPTION css=section.display-sheets > table > tbody > tr:nth-child(1) > td:nth-of-type(4) > mat-checkbox > label > div");
	 selenium.click("css=section.display-sheets > table > tbody > tr:nth-child(1) > td:nth-of-type(5) > mat-checkbox > label > div")
	 selenium.fireEvent("css= td.cdk-column-xls_sheet_index.mat-column-xls_sheet_index > input", "change")
	 selenium.click("css=app-document-settings > mat-dialog-actions > button.mat-raised-button.mat-accent")
	 selenium.click("css=app-document > section > subreport > div > sheet > mat-card > div > div > button > span > span")
	 selenium.type("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div > div:nth-child(2) > div:nth-child(1) > input", "1")
	 selenium.type("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div > div:nth-child(2) > div:nth-child(2) > input", "0")
	 selenium.select("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div > div:nth-child(3) > div:nth-child(1) > select", "value=;")
	 selenium.click("css=#cumulative")
	 selenium.click("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div:nth-child(2) > button")
	 Thread.sleep(1500);
	 selenium.refresh()
	 selenium.waitForPageToLoad("")
	 selenium.click("css=app-document > section > subreport > div > sheet > mat-card > div > div > button > span > span")
	 selenium.type("css=input#fileUpload", "${smallerCsvFullPath}")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div.preview-info")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 String currentDate = selenium.getEval("var today = new Date(); today.toISOString().substring(0,10);")
	 verifyEquals("Cumulated CSV of 1 iterations - Total rows : 7", selenium.getText("css=div.preview-info"));
	 assertEquals("First line of first CSVPlacementDateDBM Cost (Account Currency)OR-Mobile_2018-01_Sales : or_mobile_cv_acquisition-terminal _2018-01: Total ConversionsOR-Mobile_2018-01_Sales : or_mobile_cv_fidelisation-terminal_2018-01: Total ConversionsOR-Mobile_2018-01_Sales : or_mobile_cv_acquisition-forfait-multi-ligne_2018-01: Total ConversionsOR-Mobile_2018-01_Sales : or_mobile_cv_acquisition-forfait_2018-01: Total ConversionsSH-Mobile_2018-01_Sales : sh_mobile_cv_acquisition-offre-mobile_2018-01: Total ConversionsSH-Mobile_2018-01_Sales : sh_mobile_cv_acquisition-terminal _2018-01: Total ConversionsOR-FAI_2018-01_Sales : or_fai_cv_confirmation-acquisition-internet-fibre_2018-01: Total ConversionsOR-FAI_2018-01_Sales : or_fai_cv_confirmation-migration-xdsl-vers-fibre_2018-01: Total ConversionsOR-Open_2018-01_Sales : or_open_cv_acquisition-open-fibre_2018-05: Total ConversionsOR-Open_2018-01_Sales : or_open_cv_migration-open-xdsl-vers-fibre_2018-01: Total ConversionsOR-FAI_2018-01_Sales : or_fai_cv_confirmation-acquisition-internet-xdsl_2018-01: Total ConversionsOR-Open_2018-01_Sales : or_open_cv_acquisition-open-xdsl_2018-01: Total ConversionsSH-Mobile-Livebox_2018-01_Sales : sh_mobile-livebox_cv_acq-offre-convergente_2018-01: Total ConversionsSH-Box-Internet_2018-08_Sales : sh_box-internet_cv_confirmation-acquisition-internet-adsl_2018-08: Total ConversionsSH-Box-Internet_2018-08_Sales : sh_box-internet_cv_confirmation-acquisition-internet-fibre_2018-10: Total ConversionsFR Orange Internet22183140_tradelab_odr_pcc_multi-format-native1_cpm_mob_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20194.080.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_pcc_multi-format-native2_cpm_web_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20194.570.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_pcc_multi-format-native3_cpm_mob_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20194.480.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_320x480_cpm_mob_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/20192.280.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_728x90_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201990.440.000.000.000.004.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_970x250_cpm_web_dis-eve_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201912.950.000.000.000.000.001.000.000.000.000.000.000.000.000.000.00Last line of first CSV------13367.257.0029.008.0013.0051.0014.003.001.001.000.008.000.000.0011.009.00", selenium.getText("css=table.preview-table:nth-of-type(1)"));
	 String currentReportUrl = selenium.getEval("document.location.href")
	 selenium.open("http://${currentEnvironment}-reportfolio-api.tradelab.fr/internals/commander/index.php")
	 selenium.waitForPageToLoad("")
	 assertTrue(selenium.isElementPresent("css=body > p > a > button"));
	 selenium.click("css=body > p > a > button")
	 selenium.waitForPageToLoad("30000")
	 String currentTime = selenium.getValue("css=#delta_interval")
	 selenium.type("css=#delta_interval", "P1D")
	 selenium.click("css=form > p > input[type=\"submit\"]")
	 selenium.waitForPageToLoad("30000")
	 Thread.sleep(3000);
	 selenium.open(currentReportUrl)
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div.option.schedule > label > i")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=div.option.schedule > label > i")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (!selenium.isVisible("css=div.option.schedule > button:nth-of-type(2)")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=document-setup > mat-card > mat-card-content > div.option.schedule > button")
	 selenium.click("css=sat-datepicker-toggle > button")
	 String tomorrow = selenium.getEval("const date = new Date(); date.setDate(date.getDate() + 1); const options = { year: 'numeric', month: 'long', day: 'numeric' }; new Intl.DateTimeFormat('en-US', options).format(date)")
	 String isMonthChange = selenium.getEval("const date = new Date(); var firstMonth = date.getMonth(); date.setDate(date.getDate() + 1); var secondMonth = date.getMonth(); firstMonth != secondMonth")
	 String tomorrowNumeric = selenium.getEval("const date = new Date(); date.setDate(date.getDate() + 1); const options = { year: 'numeric', month: 'numeric', day: 'numeric' }; new Intl.DateTimeFormat('fr-FR', options).format(date).replace(/(\\d+)\\/(\\d+)\\/(\\d+)/, '$3-$2-$1')")
	 selenium.if(isMonthChange + " == 1")
	 selenium.click("css=button.mat-calendar-next-button")
	 selenium.endIf()
	 selenium.click("css=[aria-label=\"" + tomorrow + "\"]")
	 selenium.click("css=[aria-label=\"" + tomorrow + "\"]")
	 selenium.click("css=document-scheduler > div.mat-dialog-actions > button.mat-raised-button.mat-accent")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("xpath=//*[text()='Report " + tomorrowNumeric + "']")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.type("css=input#fileUpload", "${smallerCsvTwoFullPath}")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div.preview-info")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 String currentDate = selenium.getEval("var today = new Date(); today.toISOString().substring(0,10);")
	 verifyEquals("Cumulated CSV of 2 iterations - Total rows : 14", selenium.getText("css=div.preview-info"));
	 assertEquals("First line of first CSVPlacementDateDBM Cost (Account Currency)OR-Mobile_2018-01_Sales : or_mobile_cv_acquisition-terminal _2018-01: Total ConversionsOR-Mobile_2018-01_Sales : or_mobile_cv_fidelisation-terminal_2018-01: Total ConversionsOR-Mobile_2018-01_Sales : or_mobile_cv_acquisition-forfait-multi-ligne_2018-01: Total ConversionsOR-Mobile_2018-01_Sales : or_mobile_cv_acquisition-forfait_2018-01: Total ConversionsSH-Mobile_2018-01_Sales : sh_mobile_cv_acquisition-offre-mobile_2018-01: Total ConversionsSH-Mobile_2018-01_Sales : sh_mobile_cv_acquisition-terminal _2018-01: Total ConversionsOR-FAI_2018-01_Sales : or_fai_cv_confirmation-acquisition-internet-fibre_2018-01: Total ConversionsOR-FAI_2018-01_Sales : or_fai_cv_confirmation-migration-xdsl-vers-fibre_2018-01: Total ConversionsOR-Open_2018-01_Sales : or_open_cv_acquisition-open-fibre_2018-05: Total ConversionsOR-Open_2018-01_Sales : or_open_cv_migration-open-xdsl-vers-fibre_2018-01: Total ConversionsOR-FAI_2018-01_Sales : or_fai_cv_confirmation-acquisition-internet-xdsl_2018-01: Total ConversionsOR-Open_2018-01_Sales : or_open_cv_acquisition-open-xdsl_2018-01: Total ConversionsSH-Mobile-Livebox_2018-01_Sales : sh_mobile-livebox_cv_acq-offre-convergente_2018-01: Total ConversionsSH-Box-Internet_2018-08_Sales : sh_box-internet_cv_confirmation-acquisition-internet-adsl_2018-08: Total ConversionsSH-Box-Internet_2018-08_Sales : sh_box-internet_cv_confirmation-acquisition-internet-fibre_2018-10: Total ConversionsFR Orange Internet22183140_tradelab_odr_pcc_multi-format-native1_cpm_mob_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20194.080.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_pcc_multi-format-native2_cpm_web_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20194.570.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_pcc_multi-format-native3_cpm_mob_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20194.480.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_320x480_cpm_mob_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/20192.280.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_728x90_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201990.440.000.000.000.004.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_970x250_cpm_web_dis-eve_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201912.950.000.000.000.000.001.000.000.000.000.000.000.000.000.000.00Last line of first CSV------13367.257.0029.008.0013.0051.0014.003.001.001.000.008.000.000.0011.009.00FR Orange Internet22183140_tradelab_odr_pcc_multi-format-native1_cpm_mob_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20194.080.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_pcc_multi-format-native2_cpm_web_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20194.570.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_pcc_multi-format-native3_cpm_mob_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20194.480.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_320x480_cpm_mob_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/20192.280.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_728x90_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201990.440.000.000.000.004.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_970x250_cpm_web_dis-eve_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201912.950.000.000.000.000.001.000.000.000.000.000.000.000.000.000.00Last line of second CSV------13367.257.0029.008.0013.0051.0014.003.001.001.000.008.000.000.0011.009.00", selenium.getText("css=table.preview-table:nth-of-type(1)"));
	 selenium.open("http://${currentEnvironment}-reportfolio-api.tradelab.fr/internals/commander/index.php")
	 selenium.waitForPageToLoad("")
	 assertTrue(selenium.isElementPresent("css=body > p > a > button"));
	 selenium.click("css=body > p > a > button")
	 selenium.waitForPageToLoad("30000")
	 String currentTime = selenium.getValue("css=#delta_interval")
	 selenium.type("css=#delta_interval", "P2D")
	 selenium.click("css=form > p > input[type=\"submit\"]")
	 selenium.waitForPageToLoad("30000")
	 Thread.sleep(3000);
	 selenium.open(currentReportUrl)
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div.option.schedule > label > i")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=div.option.schedule > label > i")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (!selenium.isVisible("css=div.option.schedule > button:nth-of-type(2)")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=document-setup > mat-card > mat-card-content > div.option.schedule > button")
	 selenium.click("css=sat-datepicker-toggle > button")
	 String dayAfterTomorrow = selenium.getEval("const date = new Date(); date.setDate(date.getDate() + 2); const options = { year: 'numeric', month: 'long', day: 'numeric' }; new Intl.DateTimeFormat('en-US', options).format(date)")
	 String isMonthChange = selenium.getEval("const date = new Date(); var firstMonth = date.getMonth(); date.setDate(date.getDate() + 2); var secondMonth = date.getMonth(); firstMonth != secondMonth")
	 String dayAfterTomorrowNumeric = selenium.getEval("const date = new Date(); date.setDate(date.getDate() + 2); const options = { year: 'numeric', month: 'numeric', day: 'numeric' }; new Intl.DateTimeFormat('fr-FR', options).format(date).replace(/(\\d+)\\/(\\d+)\\/(\\d+)/, '$3-$2-$1')")
	 selenium.if(isMonthChange + " == 1")
	 selenium.click("css=button.mat-calendar-next-button")
	 selenium.endIf()
	 selenium.click("css=[aria-label=\"" + dayAfterTomorrow + "\"]")
	 selenium.click("css=[aria-label=\"" + dayAfterTomorrow + "\"]")
	 selenium.click("css=document-scheduler > div.mat-dialog-actions > button.mat-raised-button.mat-accent")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("xpath=//*[text()='Report " + dayAfterTomorrowNumeric + "']")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.type("css=input#fileUpload", "${smallerCsvThreeFullPath}")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div.preview-info")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 String currentDate = selenium.getEval("var today = new Date(); today.toISOString().substring(0,10);")
	 verifyEquals("Cumulated CSV of 3 iterations - Total rows : 21", selenium.getText("css=div.preview-info"));
	 assertEquals("First line of first CSVPlacementDateDBM Cost (Account Currency)OR-Mobile_2018-01_Sales : or_mobile_cv_acquisition-terminal _2018-01: Total ConversionsOR-Mobile_2018-01_Sales : or_mobile_cv_fidelisation-terminal_2018-01: Total ConversionsOR-Mobile_2018-01_Sales : or_mobile_cv_acquisition-forfait-multi-ligne_2018-01: Total ConversionsOR-Mobile_2018-01_Sales : or_mobile_cv_acquisition-forfait_2018-01: Total ConversionsSH-Mobile_2018-01_Sales : sh_mobile_cv_acquisition-offre-mobile_2018-01: Total ConversionsSH-Mobile_2018-01_Sales : sh_mobile_cv_acquisition-terminal _2018-01: Total ConversionsOR-FAI_2018-01_Sales : or_fai_cv_confirmation-acquisition-internet-fibre_2018-01: Total ConversionsOR-FAI_2018-01_Sales : or_fai_cv_confirmation-migration-xdsl-vers-fibre_2018-01: Total ConversionsOR-Open_2018-01_Sales : or_open_cv_acquisition-open-fibre_2018-05: Total ConversionsOR-Open_2018-01_Sales : or_open_cv_migration-open-xdsl-vers-fibre_2018-01: Total ConversionsOR-FAI_2018-01_Sales : or_fai_cv_confirmation-acquisition-internet-xdsl_2018-01: Total ConversionsOR-Open_2018-01_Sales : or_open_cv_acquisition-open-xdsl_2018-01: Total ConversionsSH-Mobile-Livebox_2018-01_Sales : sh_mobile-livebox_cv_acq-offre-convergente_2018-01: Total ConversionsSH-Box-Internet_2018-08_Sales : sh_box-internet_cv_confirmation-acquisition-internet-adsl_2018-08: Total ConversionsSH-Box-Internet_2018-08_Sales : sh_box-internet_cv_confirmation-acquisition-internet-fibre_2018-10: Total ConversionsFR Orange Internet22183140_tradelab_odr_pcc_multi-format-native1_cpm_mob_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20194.080.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_pcc_multi-format-native2_cpm_web_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20194.570.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_pcc_multi-format-native3_cpm_mob_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20194.480.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_320x480_cpm_mob_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/20192.280.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_728x90_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201990.440.000.000.000.004.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_970x250_cpm_web_dis-eve_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201912.950.000.000.000.000.001.000.000.000.000.000.000.000.000.000.00Last line of first CSV------13367.257.0029.008.0013.0051.0014.003.001.001.000.008.000.000.0011.009.00FR Orange Internet22183140_tradelab_odr_pcc_multi-format-native1_cpm_mob_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20194.080.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_pcc_multi-format-native2_cpm_web_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20194.570.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_pcc_multi-format-native3_cpm_mob_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20194.480.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00", selenium.getText("css=table.preview-table:nth-of-type(1)"));
	 verifyTrue(selenium.isVisible("css=div.spliter"));
	 verifyEquals("FR Sosh Mobile22330690_tradelab_terminaux_std_728x90_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201990.440.000.000.000.004.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_970x250_cpm_web_dis-eve_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201912.950.000.000.000.000.001.000.000.000.000.000.000.000.000.000.00Last line of second CSV------13367.257.0029.008.0013.0051.0014.003.001.001.000.008.000.000.0011.009.00FR Orange Internet22183140_tradelab_odr_pcc_multi-format-native1_cpm_mob_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20194.080.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_pcc_multi-format-native2_cpm_web_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20194.570.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_pcc_multi-format-native3_cpm_mob_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20194.480.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_320x480_cpm_mob_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/20192.280.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_728x90_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201990.440.000.000.000.004.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_970x250_cpm_web_dis-eve_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201912.950.000.000.000.000.001.000.000.000.000.000.000.000.000.000.00Last line of third CSV------13367.257.0029.008.0013.0051.0014.003.001.001.000.008.000.000.0011.009.00", selenium.getText("css=table.preview-table:nth-of-type(2)"));
	 selenium.click("css=document-setup > div > div > button:nth-of-type(3)")
	 selenium.if("${downloadReport} == 1")
	 String waitForReport = "5000"
	 String remainingAttempts = "40"
	 boolean canDownloadReport = selenium.isElementPresent("css=div.cdk-overlay-pane > div > div > button[aria-disabled=\"false\"]")
	 selenium.while(canDownloadReport + " == 0 && " + remainingAttempts + " > 0")
	 Thread.sleep(NaN);
	 selenium.refresh()
	 selenium.waitForPageToLoad("")
	 selenium.click("css=document-setup > div > div > button:nth-of-type(3)")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div.cdk-overlay-pane > div > div > button")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 boolean canDownloadReport = selenium.isElementPresent("css=div.cdk-overlay-pane > div > div > button[aria-disabled=\"false\"]")
	 String remainingAttempts = selenium.getEval("remainingAttempts - 1")
	 selenium.endWhile()
	 selenium.click("css=div.cdk-overlay-pane > div > div > button[aria-disabled=\"false\"]")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=snack-bar-container > simple-snack-bar")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.endIf()
	 selenium.open("http://${currentEnvironment}-reportfolio-api.tradelab.fr/internals/commander/index.php")
	 selenium.waitForPageToLoad("")
	 assertTrue(selenium.isElementPresent("css=body > p > a > button"));
	 selenium.click("css=body > p > a > button")
	 selenium.waitForPageToLoad("30000")
	 String currentTime = selenium.getValue("css=#delta_interval")
	 selenium.if("\"" + currentTime + "\" != \"P0D\"")
	 selenium.type("css=#delta_interval", "P0D")
	 selenium.click("css=form > p > input[type=\"submit\"]")
	 selenium.waitForPageToLoad("30000")
	 selenium.endIf()
	 selenium.open(currentReportUrl)
	 Thread.sleep(2000);
	 // Start from row 2
	 selenium.click("css=button[id=\"button-new-report\"]")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=button[id=\"button-new-basic-report\"]")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=button[id=\"button-new-basic-report\"]")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div > mat-dialog-container")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=mat-dialog-content div.mat-form-field-flex > div > mat-select")
	 Thread.sleep(500);
	 selenium.click("css=div[class=\"cdk-overlay-pane\"] > div > mat-option:nth-child(1)")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div.mat-form-field-infix > input.mat-input-element")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.type("css=div.mat-form-field-infix > input.mat-input-element", "Test auto - Report - Start from row 2")
	 selenium.click("css=app-new-document-dialog > form > mat-dialog-actions > button.mat-raised-button.mat-accent > span")
	 Thread.sleep(1000);
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (!selenium.isVisible("css=div.preview-info")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=subreport > div > header > div > button > span > i")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div.mat-menu-content > button:nth-child(1)")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=div.mat-menu-content > button:nth-child(1)")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > i")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > i")
	 selenium.type("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > input", "Start from row Subreport")
	 selenium.fireEvent("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > input", "blur")
	 selenium.click("css=document-setup > mat-card > mat-card-content > div.option.schedule > button")
	 selenium.click("css=sat-datepicker-toggle > button")
	 selenium.click("css=.mat-calendar-body-today")
	 selenium.click("css=.mat-calendar-body-today")
	 selenium.click("css=document-scheduler > div.mat-dialog-actions > button.mat-raised-button.mat-accent")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (!selenium.isVisible("xpath=//*[text()='No report yet']")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.type("css=document-setup > mat-card > mat-card-content > div:nth-child(3) > form > button > span > input", "${templateFullPath}")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=document-setup > mat-card > mat-card-content > div:nth-child(3) > button:nth-of-type(2)")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=document-setup > mat-card > mat-card-content > div:nth-child(3) > button:nth-of-type(2)")
	 selenium.type("css=section.display-sheets > table > tbody > tr:nth-child(1) > td.mat-cell.cdk-column-xls_sheet_index.mat-column-xls_sheet_index.ng-star-inserted > input", "8")
	 System.out.println("ISSUE WITH OPTION css=section.display-sheets > table > tbody > tr:nth-child(1) > td:nth-of-type(4) > mat-checkbox > label > div");
	 selenium.click("css=section.display-sheets > table > tbody > tr:nth-child(1) > td:nth-of-type(5) > mat-checkbox > label > div")
	 selenium.fireEvent("css= td.cdk-column-xls_sheet_index.mat-column-xls_sheet_index > input", "change")
	 selenium.click("css=app-document-settings > mat-dialog-actions > button.mat-raised-button.mat-accent")
	 selenium.click("css=app-document > section > subreport > div > sheet > mat-card > div > div > button > span > span")
	 selenium.type("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div > div:nth-child(2) > div:nth-child(1) > input", "2")
	 selenium.select("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div > div:nth-child(3) > div:nth-child(1) > select", "value=;")
	 selenium.click("css=#cumulative")
	 selenium.click("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div:nth-child(2) > button")
	 Thread.sleep(1500);
	 selenium.refresh()
	 selenium.waitForPageToLoad("")
	 selenium.click("css=app-document > section > subreport > div > sheet > mat-card > div > div > button > span > span")
	 selenium.type("css=input#fileUpload", "${biggerCsvFullPath}")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div.preview-info")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 String currentDate = selenium.getEval("var today = new Date(); today.toISOString().substring(0,10);")
	 verifyEquals("Cumulated CSV of 1 iterations - Total rows : 806", selenium.getText("css=div.preview-info"));
	 assertEquals("Date/Time Generated2/20/19 4:39 AMReport Time ZoneEurope/ParisAccount ID743372Date Range2/19/19 - 2/19/19AdvertiserEquals:FR Orange Internet (8364571)AdvertiserEquals:FR Orange Mobile (8365738)AdvertiserEquals:FR Sosh Internet (8364841)AdvertiserEquals:FR Sosh Mobile (8364118)MRC Accredited MetricsNoneReport FieldsHeader of first CSV at line 12PlacementDateDBM Cost (Account Currency)OR-Mobile_2018-01_Sales : or_mobile_cv_acquisition-terminal _2018-01: Total ConversionsOR-Mobile_2018-01_Sales : or_mobile_cv_fidelisation-terminal_2018-01: Total ConversionsOR-Mobile_2018-01_Sales : or_mobile_cv_acquisition-forfait-multi-ligne_2018-01: Total ConversionsOR-Mobile_2018-01_Sales : or_mobile_cv_acquisition-forfait_2018-01: Total ConversionsSH-Mobile_2018-01_Sales : sh_mobile_cv_acquisition-offre-mobile_2018-01: Total ConversionsSH-Mobile_2018-01_Sales : sh_mobile_cv_acquisition-terminal _2018-01: Total ConversionsOR-FAI_2018-01_Sales : or_fai_cv_confirmation-acquisition-internet-fibre_2018-01: Total ConversionsOR-FAI_2018-01_Sales : or_fai_cv_confirmation-migration-xdsl-vers-fibre_2018-01: Total ConversionsOR-Open_2018-01_Sales : or_open_cv_acquisition-open-fibre_2018-05: Total ConversionsOR-Open_2018-01_Sales : or_open_cv_migration-open-xdsl-vers-fibre_2018-01: Total ConversionsOR-FAI_2018-01_Sales : or_fai_cv_confirmation-acquisition-internet-xdsl_2018-01: Total ConversionsOR-Open_2018-01_Sales : or_open_cv_acquisition-open-xdsl_2018-01: Total ConversionsSH-Mobile-Livebox_2018-01_Sales : sh_mobile-livebox_cv_acq-offre-convergente_2018-01: Total ConversionsSH-Box-Internet_2018-08_Sales : sh_box-internet_cv_confirmation-acquisition-internet-adsl_2018-08: Total ConversionsSH-Box-Internet_2018-08_Sales : sh_box-internet_cv_confirmation-acquisition-internet-fibre_2018-10: Total Conversions", selenium.getText("css=table.preview-table:nth-of-type(1)"));
	 verifyTrue(selenium.isVisible("css=div.spliter"));
	 verifyEquals("FR Sosh Mobile22330690_tradelab_terminaux_std_160x600_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201931.520.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_300x250_cpm_mob_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201919.710.000.000.000.000.001.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_300x250_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/2019161.630.000.000.000.004.001.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_300x50_cpm_mob_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/20199.980.000.000.000.000.000.000.000.000.000.000.000.000.001.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_300x600_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/2019130.010.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_320x480_cpm_mob_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/20192.280.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_320x50_cpm_mob_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201910.450.000.000.000.000.001.000.000.000.000.000.000.000.000.001.00FR Sosh Mobile22330690_tradelab_terminaux_std_728x90_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201990.440.000.000.000.004.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_970x250_cpm_web_dis-eve_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201912.950.000.000.000.000.001.000.000.000.000.000.000.000.000.000.00Last line of first CSV------13367.257.0029.008.0013.0051.0014.003.001.001.000.008.000.000.0011.009.00", selenium.getText("css=table.preview-table:nth-of-type(2)"));
	 selenium.click("css=document-setup > div > div > button:nth-of-type(3)")
	 selenium.if("${downloadReport} == 1")
	 String waitForReport = "5000"
	 String remainingAttempts = "40"
	 boolean canDownloadReport = selenium.isElementPresent("css=div.cdk-overlay-pane > div > div > button[aria-disabled=\"false\"]")
	 selenium.while(canDownloadReport + " == 0 && " + remainingAttempts + " > 0")
	 Thread.sleep(NaN);
	 selenium.refresh()
	 selenium.waitForPageToLoad("")
	 selenium.click("css=document-setup > div > div > button:nth-of-type(3)")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div.cdk-overlay-pane > div > div > button")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 boolean canDownloadReport = selenium.isElementPresent("css=div.cdk-overlay-pane > div > div > button[aria-disabled=\"false\"]")
	 String remainingAttempts = selenium.getEval("remainingAttempts - 1")
	 selenium.endWhile()
	 selenium.click("css=div.cdk-overlay-pane > div > div > button[aria-disabled=\"false\"]")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=snack-bar-container > simple-snack-bar")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.endIf()
	 // Start from row 12
	 selenium.click("css=button[id=\"button-new-report\"]")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=button[id=\"button-new-basic-report\"]")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=button[id=\"button-new-basic-report\"]")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div > mat-dialog-container")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=mat-dialog-content div.mat-form-field-flex > div > mat-select")
	 Thread.sleep(500);
	 selenium.click("css=div[class=\"cdk-overlay-pane\"] > div > mat-option:nth-child(1)")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div.mat-form-field-infix > input.mat-input-element")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.type("css=div.mat-form-field-infix > input.mat-input-element", "Test auto - Report - Start from row 12")
	 selenium.click("css=app-new-document-dialog > form > mat-dialog-actions > button.mat-raised-button.mat-accent > span")
	 Thread.sleep(1000);
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (!selenium.isVisible("css=div.preview-info")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=subreport > div > header > div > button > span > i")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div.mat-menu-content > button:nth-child(1)")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=div.mat-menu-content > button:nth-child(1)")
	 Thread.sleep(1500);
	 boolean isSubreportCreated = selenium.isElementPresent("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > i")
	 selenium.if(isSubreportCreated + " == 0")
	 selenium.click("css=div.mat-menu-content > button:nth-of-type(1)")
	 selenium.endIf()
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > i")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > i")
	 selenium.type("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > input", "Start from row 12 Subreport")
	 selenium.fireEvent("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > input", "blur")
	 selenium.click("css=document-setup > mat-card > mat-card-content > div.option.schedule > button")
	 selenium.click("css=sat-datepicker-toggle > button")
	 selenium.click("css=.mat-calendar-body-today")
	 selenium.click("css=.mat-calendar-body-today")
	 selenium.click("css=document-scheduler > div.mat-dialog-actions > button.mat-raised-button.mat-accent")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (!selenium.isVisible("xpath=//*[text()='No report yet']")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.type("css=document-setup > mat-card > mat-card-content > div:nth-child(3) > form > button > span > input", "${templateFullPath}")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=document-setup > mat-card > mat-card-content > div:nth-child(3) > button:nth-of-type(2)")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=document-setup > mat-card > mat-card-content > div:nth-child(3) > button:nth-of-type(2)")
	 selenium.type("css=section.display-sheets > table > tbody > tr:nth-child(1) > td.mat-cell.cdk-column-xls_sheet_index.mat-column-xls_sheet_index.ng-star-inserted > input", "8")
	 System.out.println("ISSUE WITH OPTION css=section.display-sheets > table > tbody > tr:nth-child(1) > td:nth-of-type(4) > mat-checkbox > label > div");
	 selenium.click("css=section.display-sheets > table > tbody > tr:nth-child(1) > td:nth-of-type(5) > mat-checkbox > label > div")
	 selenium.fireEvent("css= td.cdk-column-xls_sheet_index.mat-column-xls_sheet_index > input", "change")
	 selenium.click("css=app-document-settings > mat-dialog-actions > button.mat-raised-button.mat-accent")
	 selenium.click("css=app-document > section > subreport > div > sheet > mat-card > div > div > button > span > span")
	 selenium.type("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div > div:nth-child(2) > div:nth-child(1) > input", "12")
	 selenium.select("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div > div:nth-child(3) > div:nth-child(1) > select", "value=;")
	 selenium.click("css=#cumulative")
	 selenium.click("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div:nth-child(2) > button")
	 Thread.sleep(1500);
	 selenium.refresh()
	 selenium.waitForPageToLoad("")
	 selenium.click("css=app-document > section > subreport > div > sheet > mat-card > div > div > button > span > span")
	 selenium.type("css=input#fileUpload", "${biggerCsvFullPath}")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div.preview-info")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 String currentDate = selenium.getEval("var today = new Date(); today.toISOString().substring(0,10);")
	 verifyEquals("Cumulated CSV of 1 iterations - Total rows : 796", selenium.getText("css=div.preview-info"));
	 assertEquals("Header of first CSV at line 12PlacementDateDBM Cost (Account Currency)OR-Mobile_2018-01_Sales : or_mobile_cv_acquisition-terminal _2018-01: Total ConversionsOR-Mobile_2018-01_Sales : or_mobile_cv_fidelisation-terminal_2018-01: Total ConversionsOR-Mobile_2018-01_Sales : or_mobile_cv_acquisition-forfait-multi-ligne_2018-01: Total ConversionsOR-Mobile_2018-01_Sales : or_mobile_cv_acquisition-forfait_2018-01: Total ConversionsSH-Mobile_2018-01_Sales : sh_mobile_cv_acquisition-offre-mobile_2018-01: Total ConversionsSH-Mobile_2018-01_Sales : sh_mobile_cv_acquisition-terminal _2018-01: Total ConversionsOR-FAI_2018-01_Sales : or_fai_cv_confirmation-acquisition-internet-fibre_2018-01: Total ConversionsOR-FAI_2018-01_Sales : or_fai_cv_confirmation-migration-xdsl-vers-fibre_2018-01: Total ConversionsOR-Open_2018-01_Sales : or_open_cv_acquisition-open-fibre_2018-05: Total ConversionsOR-Open_2018-01_Sales : or_open_cv_migration-open-xdsl-vers-fibre_2018-01: Total ConversionsOR-FAI_2018-01_Sales : or_fai_cv_confirmation-acquisition-internet-xdsl_2018-01: Total ConversionsOR-Open_2018-01_Sales : or_open_cv_acquisition-open-xdsl_2018-01: Total ConversionsSH-Mobile-Livebox_2018-01_Sales : sh_mobile-livebox_cv_acq-offre-convergente_2018-01: Total ConversionsSH-Box-Internet_2018-08_Sales : sh_box-internet_cv_confirmation-acquisition-internet-adsl_2018-08: Total ConversionsSH-Box-Internet_2018-08_Sales : sh_box-internet_cv_confirmation-acquisition-internet-fibre_2018-10: Total ConversionsFR Orange Internet22183140_tradelab_odr_pcc_multi-format-native1_cpm_mob_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20194.080.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_pcc_multi-format-native1_cpm_web_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20190.830.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_pcc_multi-format-native2_cpm_mob_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20195.290.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_pcc_multi-format-native2_cpm_web_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20194.570.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_pcc_multi-format-native3_cpm_mob_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20194.480.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_pcc_multi-format-native3_cpm_web_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20194.620.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_std_120x600_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms__or-fai_kpi1-acquisition-bb19/02/20191.540.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_std_160x600_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms__or-fai_kpi1-acquisition-bb19/02/201910.060.000.000.000.000.000.001.000.000.000.000.000.000.001.000.00FR Orange Internet22183140_tradelab_odr_std_1800x1000_cpm_web_dis-eve_rtg_npa_retargeting_dbm_1st-tms__or-fai_kpi1-acquisition-bb19/02/201910.210.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_std_300x250_cpm_mob_dis-iab_rtg_npa_retargeting_dbm_1st-tms__or-fai_kpi1-acquisition-bb19/02/201927.220.000.000.000.000.000.000.000.000.000.001.000.000.000.000.00", selenium.getText("css=table.preview-table:nth-of-type(1)"));
	 verifyTrue(selenium.isVisible("css=div.spliter"));
	 assertEquals("FR Sosh Mobile22330690_tradelab_terminaux_std_160x600_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201931.520.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_300x250_cpm_mob_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201919.710.000.000.000.000.001.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_300x250_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/2019161.630.000.000.000.004.001.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_300x50_cpm_mob_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/20199.980.000.000.000.000.000.000.000.000.000.000.000.000.001.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_300x600_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/2019130.010.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_320x480_cpm_mob_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/20192.280.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_320x50_cpm_mob_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201910.450.000.000.000.000.001.000.000.000.000.000.000.000.000.001.00FR Sosh Mobile22330690_tradelab_terminaux_std_728x90_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201990.440.000.000.000.004.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_970x250_cpm_web_dis-eve_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201912.950.000.000.000.000.001.000.000.000.000.000.000.000.000.000.00Last line of first CSV------13367.257.0029.008.0013.0051.0014.003.001.001.000.008.000.000.0011.009.00", selenium.getText("css=table.preview-table:nth-of-type(2)"));
	 selenium.click("css=document-setup > div > div > button:nth-of-type(3)")
	 selenium.if("${downloadReport} == 1")
	 String waitForReport = "5000"
	 String remainingAttempts = "40"
	 boolean canDownloadReport = selenium.isElementPresent("css=div.cdk-overlay-pane > div > div > button[aria-disabled=\"false\"]")
	 selenium.while(canDownloadReport + " == 0 && " + remainingAttempts + " > 0")
	 Thread.sleep(NaN);
	 selenium.refresh()
	 selenium.waitForPageToLoad("")
	 selenium.click("css=document-setup > div > div > button:nth-of-type(3)")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div.cdk-overlay-pane > div > div > button")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 boolean canDownloadReport = selenium.isElementPresent("css=div.cdk-overlay-pane > div > div > button[aria-disabled=\"false\"]")
	 String remainingAttempts = selenium.getEval("remainingAttempts - 1")
	 selenium.endWhile()
	 selenium.click("css=div.cdk-overlay-pane > div > div > button[aria-disabled=\"false\"]")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=snack-bar-container > simple-snack-bar")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.endIf()
	 // Exclude last 2
	 selenium.click("css=button[id=\"button-new-report\"]")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=button[id=\"button-new-basic-report\"]")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=button[id=\"button-new-basic-report\"]")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div > mat-dialog-container")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=mat-dialog-content div.mat-form-field-flex > div > mat-select")
	 Thread.sleep(500);
	 selenium.click("css=div[class=\"cdk-overlay-pane\"] > div > mat-option:nth-child(1)")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div.mat-form-field-infix > input.mat-input-element")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.type("css=div.mat-form-field-infix > input.mat-input-element", "Test auto - Report - Exclude last 2")
	 selenium.click("css=app-new-document-dialog > form > mat-dialog-actions > button.mat-raised-button.mat-accent > span")
	 Thread.sleep(1000);
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (!selenium.isVisible("css=div.preview-info")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=subreport > div > header > div > button > span > i")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div.mat-menu-content > button:nth-child(1)")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=div.mat-menu-content > button:nth-child(1)")
	 Thread.sleep(1500);
	 boolean isSubreportCreated = selenium.isElementPresent("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > i")
	 selenium.if(isSubreportCreated + " == 0")
	 selenium.click("css=div.mat-menu-content > button:nth-of-type(1)")
	 selenium.endIf()
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > i")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > i")
	 selenium.type("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > input", "Exclude last Subreport")
	 selenium.fireEvent("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > input", "blur")
	 selenium.click("css=document-setup > mat-card > mat-card-content > div.option.schedule > button")
	 selenium.click("css=sat-datepicker-toggle > button")
	 selenium.click("css=.mat-calendar-body-today")
	 selenium.click("css=.mat-calendar-body-today")
	 selenium.click("css=document-scheduler > div.mat-dialog-actions > button.mat-raised-button.mat-accent")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (!selenium.isVisible("xpath=//*[text()='No report yet']")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.type("css=document-setup > mat-card > mat-card-content > div:nth-child(3) > form > button > span > input", "${templateFullPath}")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=document-setup > mat-card > mat-card-content > div:nth-child(3) > button:nth-of-type(2)")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=document-setup > mat-card > mat-card-content > div:nth-child(3) > button:nth-of-type(2)")
	 selenium.type("css=section.display-sheets > table > tbody > tr:nth-child(1) > td.mat-cell.cdk-column-xls_sheet_index.mat-column-xls_sheet_index.ng-star-inserted > input", "8")
	 System.out.println("ISSUE WITH OPTION css=section.display-sheets > table > tbody > tr:nth-child(1) > td:nth-of-type(4) > mat-checkbox > label > div");
	 selenium.click("css=section.display-sheets > table > tbody > tr:nth-child(1) > td:nth-of-type(5) > mat-checkbox > label > div")
	 selenium.fireEvent("css= td.cdk-column-xls_sheet_index.mat-column-xls_sheet_index > input", "change")
	 selenium.click("css=app-document-settings > mat-dialog-actions > button.mat-raised-button.mat-accent")
	 selenium.click("css=app-document > section > subreport > div > sheet > mat-card > div > div > button > span > span")
	 selenium.type("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div > div:nth-child(2) > div:nth-child(2) > input", "2")
	 selenium.select("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div > div:nth-child(3) > div:nth-child(1) > select", "value=;")
	 selenium.click("css=#cumulative")
	 selenium.click("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div:nth-child(2) > button")
	 Thread.sleep(1500);
	 selenium.refresh()
	 selenium.waitForPageToLoad("")
	 selenium.click("css=app-document > section > subreport > div > sheet > mat-card > div > div > button > span > span")
	 selenium.type("css=input#fileUpload", "${biggerCsvFullPath}")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div.preview-info")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 String currentDate = selenium.getEval("var today = new Date(); today.toISOString().substring(0,10);")
	 verifyEquals("Cumulated CSV of 1 iterations - Total rows : 805", selenium.getText("css=div.preview-info"));
	 assertEquals("First line of first CSVDate/Time Generated2/20/19 4:39 AMReport Time ZoneEurope/ParisAccount ID743372Date Range2/19/19 - 2/19/19AdvertiserEquals:FR Orange Internet (8364571)AdvertiserEquals:FR Orange Mobile (8365738)AdvertiserEquals:FR Sosh Internet (8364841)AdvertiserEquals:FR Sosh Mobile (8364118)MRC Accredited MetricsNoneReport Fields", selenium.getText("css=table.preview-table:nth-of-type(1)"));
	 verifyTrue(selenium.isVisible("css=div.spliter"));
	 verifyEquals("FR Sosh Mobile22275335_tradelab_stvalentin_std_970x250_cpm_web_dis-eve_prosp_npa_prospectionalgo_dbm_ _sosh_kpi4-terminaux-mobile_kpi4-terminaux-mobile19/02/20195.870.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_120x600_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/20198.100.000.000.000.002.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_160x600_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201931.520.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_300x250_cpm_mob_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201919.710.000.000.000.000.001.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_300x250_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/2019161.630.000.000.000.004.001.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_300x50_cpm_mob_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/20199.980.000.000.000.000.000.000.000.000.000.000.000.000.001.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_300x600_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/2019130.010.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_320x480_cpm_mob_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/20192.280.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_320x50_cpm_mob_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201910.450.000.000.000.000.001.000.000.000.000.000.000.000.000.001.00FR Sosh Mobile22330690_tradelab_terminaux_std_728x90_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201990.440.000.000.000.004.000.000.000.000.000.000.000.000.000.000.00", selenium.getText("css=table.preview-table:nth-of-type(2)"));
	 selenium.click("css=document-setup > div > div > button:nth-of-type(3)")
	 selenium.if("${downloadReport} == 1")
	 String waitForReport = "5000"
	 String remainingAttempts = "40"
	 boolean canDownloadReport = selenium.isElementPresent("css=div.cdk-overlay-pane > div > div > button[aria-disabled=\"false\"]")
	 selenium.while(canDownloadReport + " == 0 && " + remainingAttempts + " > 0")
	 Thread.sleep(NaN);
	 selenium.refresh()
	 selenium.waitForPageToLoad("")
	 selenium.click("css=document-setup > div > div > button:nth-of-type(3)")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div.cdk-overlay-pane > div > div > button")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 boolean canDownloadReport = selenium.isElementPresent("css=div.cdk-overlay-pane > div > div > button[aria-disabled=\"false\"]")
	 String remainingAttempts = selenium.getEval("remainingAttempts - 1")
	 selenium.endWhile()
	 selenium.click("css=div.cdk-overlay-pane > div > div > button[aria-disabled=\"false\"]")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=snack-bar-container > simple-snack-bar")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.endIf()
	 // Exclude last 12
	 selenium.click("css=button[id=\"button-new-report\"]")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=button[id=\"button-new-basic-report\"]")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=button[id=\"button-new-basic-report\"]")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div > mat-dialog-container")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=mat-dialog-content div.mat-form-field-flex > div > mat-select")
	 Thread.sleep(500);
	 selenium.click("css=div[class=\"cdk-overlay-pane\"] > div > mat-option:nth-child(1)")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div.mat-form-field-infix > input.mat-input-element")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.type("css=div.mat-form-field-infix > input.mat-input-element", "Test auto - Report - Exclude last 12")
	 selenium.click("css=app-new-document-dialog > form > mat-dialog-actions > button.mat-raised-button.mat-accent > span")
	 Thread.sleep(1000);
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (!selenium.isVisible("css=div.preview-info")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=subreport > div > header > div > button > span > i")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div.mat-menu-content > button:nth-child(1)")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=div.mat-menu-content > button:nth-child(1)")
	 Thread.sleep(1500);
	 boolean isSubreportCreated = selenium.isElementPresent("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > i")
	 selenium.if(isSubreportCreated + " == 0")
	 selenium.click("css=div.mat-menu-content > button:nth-of-type(1)")
	 selenium.endIf()
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > i")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > i")
	 selenium.type("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > input", "Exclude last Subreport")
	 selenium.fireEvent("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > input", "blur")
	 selenium.click("css=document-setup > mat-card > mat-card-content > div.option.schedule > button")
	 selenium.click("css=sat-datepicker-toggle > button")
	 selenium.click("css=.mat-calendar-body-today")
	 selenium.click("css=.mat-calendar-body-today")
	 selenium.click("css=document-scheduler > div.mat-dialog-actions > button.mat-raised-button.mat-accent")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (!selenium.isVisible("xpath=//*[text()='No report yet']")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.type("css=document-setup > mat-card > mat-card-content > div:nth-child(3) > form > button > span > input", "${templateFullPath}")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=document-setup > mat-card > mat-card-content > div:nth-child(3) > button:nth-of-type(2)")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=document-setup > mat-card > mat-card-content > div:nth-child(3) > button:nth-of-type(2)")
	 selenium.type("css=section.display-sheets > table > tbody > tr:nth-child(1) > td.mat-cell.cdk-column-xls_sheet_index.mat-column-xls_sheet_index.ng-star-inserted > input", "8")
	 System.out.println("ISSUE WITH OPTION css=section.display-sheets > table > tbody > tr:nth-child(1) > td:nth-of-type(4) > mat-checkbox > label > div");
	 selenium.click("css=section.display-sheets > table > tbody > tr:nth-child(1) > td:nth-of-type(5) > mat-checkbox > label > div")
	 selenium.fireEvent("css= td.cdk-column-xls_sheet_index.mat-column-xls_sheet_index > input", "change")
	 selenium.click("css=app-document-settings > mat-dialog-actions > button.mat-raised-button.mat-accent")
	 selenium.click("css=app-document > section > subreport > div > sheet > mat-card > div > div > button > span > span")
	 selenium.type("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div > div:nth-child(2) > div:nth-child(2) > input", "12")
	 selenium.select("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div > div:nth-child(3) > div:nth-child(1) > select", "value=;")
	 selenium.click("css=#cumulative")
	 selenium.click("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div:nth-child(2) > button")
	 Thread.sleep(1500);
	 selenium.refresh()
	 selenium.waitForPageToLoad("")
	 selenium.click("css=app-document > section > subreport > div > sheet > mat-card > div > div > button > span > span")
	 selenium.type("css=input#fileUpload", "${biggerCsvFullPath}")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div.preview-info")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 String currentDate = selenium.getEval("var today = new Date(); today.toISOString().substring(0,10);")
	 verifyEquals("Cumulated CSV of 1 iterations - Total rows : 795", selenium.getText("css=div.preview-info"));
	 assertEquals("First line of first CSVDate/Time Generated2/20/19 4:39 AMReport Time ZoneEurope/ParisAccount ID743372Date Range2/19/19 - 2/19/19AdvertiserEquals:FR Orange Internet (8364571)AdvertiserEquals:FR Orange Mobile (8365738)AdvertiserEquals:FR Sosh Internet (8364841)AdvertiserEquals:FR Sosh Mobile (8364118)MRC Accredited MetricsNoneReport Fields", selenium.getText("css=table.preview-table:nth-of-type(1)"));
	 verifyTrue(selenium.isVisible("css=div.spliter"));
	 verifyEquals("FR Sosh Mobile22275335_tradelab_stvalentin_std_300x50_cpm_mob_dis-iab_prosp_npa_prospectionalgo_dbm_ _sosh_kpi4-terminaux-mobile_kpi4-terminaux-mobile19/02/20199.550.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22275335_tradelab_stvalentin_std_300x600_cpm_web_dis-iab_prosp_npa_profiling_dbm_2nd-tl_sosh_kpi4-terminaux-mobile19/02/20190.720.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22275335_tradelab_stvalentin_std_300x600_cpm_web_dis-iab_prosp_npa_profiling_dbm_3rd-classique_sosh_kpi4-terminaux-mobile19/02/2019162.900.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22275335_tradelab_stvalentin_std_300x600_cpm_web_dis-iab_prosp_npa_prospectionalgo_dbm_ _sosh_kpi4-terminaux-mobile_kpi4-terminaux-mobile19/02/201963.250.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22275335_tradelab_stvalentin_std_320x50_cpm_mob_dis-iab_prosp_npa_prospectionalgo_dbm_ _sosh_kpi4-terminaux-mobile_kpi4-terminaux-mobile19/02/201930.550.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22275335_tradelab_stvalentin_std_728x90_cpm_web_dis-iab_prosp_npa_profiling_dbm_2nd-tl_sosh_kpi4-terminaux-mobile19/02/20190.620.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22275335_tradelab_stvalentin_std_728x90_cpm_web_dis-iab_prosp_npa_profiling_dbm_3rd-classique_sosh_kpi4-terminaux-mobile19/02/2019124.150.000.000.000.004.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22275335_tradelab_stvalentin_std_728x90_cpm_web_dis-iab_prosp_npa_prospectionalgo_dbm_ _sosh_kpi4-terminaux-mobile_kpi4-terminaux-mobile19/02/201942.060.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22275335_tradelab_stvalentin_std_970x250_cpm_web_dis-eve_prosp_npa_profiling_dbm_2nd-tl_sosh_kpi4-terminaux-mobile_kpi4-terminaux-mobile19/02/20190.050.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22275335_tradelab_stvalentin_std_970x250_cpm_web_dis-eve_prosp_npa_profiling_dbm_3rd-classique_sosh_kpi4-terminaux-mobile_kpi4-terminaux-mobile19/02/20198.050.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00", selenium.getText("css=table.preview-table:nth-of-type(2)"));
	 selenium.click("css=document-setup > div > div > button:nth-of-type(3)")
	 selenium.if("${downloadReport} == 1")
	 String waitForReport = "5000"
	 String remainingAttempts = "40"
	 boolean canDownloadReport = selenium.isElementPresent("css=div.cdk-overlay-pane > div > div > button[aria-disabled=\"false\"]")
	 selenium.while(canDownloadReport + " == 0 && " + remainingAttempts + " > 0")
	 Thread.sleep(NaN);
	 selenium.refresh()
	 selenium.waitForPageToLoad("")
	 selenium.click("css=document-setup > div > div > button:nth-of-type(3)")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div.cdk-overlay-pane > div > div > button")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 boolean canDownloadReport = selenium.isElementPresent("css=div.cdk-overlay-pane > div > div > button[aria-disabled=\"false\"]")
	 String remainingAttempts = selenium.getEval("remainingAttempts - 1")
	 selenium.endWhile()
	 selenium.click("css=div.cdk-overlay-pane > div > div > button[aria-disabled=\"false\"]")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=snack-bar-container > simple-snack-bar")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.endIf()
	 // Start from row 12 + Exclude last 12
	 selenium.click("css=button[id=\"button-new-report\"]")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=button[id=\"button-new-basic-report\"]")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=button[id=\"button-new-basic-report\"]")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div > mat-dialog-container")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=mat-dialog-content div.mat-form-field-flex > div > mat-select")
	 Thread.sleep(500);
	 selenium.click("css=div[class=\"cdk-overlay-pane\"] > div > mat-option:nth-child(1)")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div.mat-form-field-infix > input.mat-input-element")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.type("css=div.mat-form-field-infix > input.mat-input-element", "Test auto - Report - Start from row 12 + Exclude last 12")
	 selenium.click("css=app-new-document-dialog > form > mat-dialog-actions > button.mat-raised-button.mat-accent > span")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (!selenium.isVisible("css=div.preview-info")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 Thread.sleep(1000);
	 selenium.click("css=subreport > div > header > div > button > span > i")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div.mat-menu-content > button:nth-child(1)")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=div.mat-menu-content > button:nth-child(1)")
	 Thread.sleep(1500);
	 boolean isSubreportCreated = selenium.isElementPresent("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > i")
	 selenium.if(isSubreportCreated + " == 0")
	 selenium.click("css=div.mat-menu-content > button:nth-of-type(1)")
	 selenium.endIf()
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > i")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > i")
	 selenium.type("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > input", "Start from row 12 + Exclude last 12 Subreport")
	 selenium.fireEvent("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > input", "blur")
	 selenium.click("css=document-setup > mat-card > mat-card-content > div.option.schedule > button")
	 selenium.click("css=sat-datepicker-toggle > button")
	 selenium.click("css=.mat-calendar-body-today")
	 selenium.click("css=.mat-calendar-body-today")
	 selenium.click("css=document-scheduler > div.mat-dialog-actions > button.mat-raised-button.mat-accent")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (!selenium.isVisible("xpath=//*[text()='No report yet']")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.type("css=document-setup > mat-card > mat-card-content > div:nth-child(3) > form > button > span > input", "${templateFullPath}")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=document-setup > mat-card > mat-card-content > div:nth-child(3) > button:nth-of-type(2)")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=document-setup > mat-card > mat-card-content > div:nth-child(3) > button:nth-of-type(2)")
	 selenium.type("css=section.display-sheets > table > tbody > tr:nth-child(1) > td.mat-cell.cdk-column-xls_sheet_index.mat-column-xls_sheet_index.ng-star-inserted > input", "8")
	 System.out.println("ISSUE WITH OPTION css=section.display-sheets > table > tbody > tr:nth-child(1) > td:nth-of-type(4) > mat-checkbox > label > div");
	 selenium.click("css=section.display-sheets > table > tbody > tr:nth-child(1) > td:nth-of-type(5) > mat-checkbox > label > div")
	 selenium.fireEvent("css= td.cdk-column-xls_sheet_index.mat-column-xls_sheet_index > input", "change")
	 selenium.click("css=app-document-settings > mat-dialog-actions > button.mat-raised-button.mat-accent")
	 selenium.click("css=app-document > section > subreport > div > sheet > mat-card > div > div > button > span > span")
	 selenium.type("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div > div:nth-child(2) > div:nth-child(1) > input", "12")
	 selenium.type("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div > div:nth-child(2) > div:nth-child(2) > input", "12")
	 selenium.select("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div > div:nth-child(3) > div:nth-child(1) > select", "value=;")
	 selenium.click("css=#cumulative")
	 selenium.click("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div:nth-child(2) > button")
	 Thread.sleep(1500);
	 selenium.refresh()
	 selenium.waitForPageToLoad("")
	 selenium.click("css=app-document > section > subreport > div > sheet > mat-card > div > div > button > span > span")
	 selenium.type("css=input#fileUpload", "${biggerCsvFullPath}")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div.preview-info")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 String currentDate = selenium.getEval("var today = new Date(); today.toISOString().substring(0,10);")
	 verifyEquals("Cumulated CSV of 1 iterations - Total rows : 784", selenium.getText("css=div.preview-info"));
	 assertEquals("Header of first CSV at line 12PlacementDateDBM Cost (Account Currency)OR-Mobile_2018-01_Sales : or_mobile_cv_acquisition-terminal _2018-01: Total ConversionsOR-Mobile_2018-01_Sales : or_mobile_cv_fidelisation-terminal_2018-01: Total ConversionsOR-Mobile_2018-01_Sales : or_mobile_cv_acquisition-forfait-multi-ligne_2018-01: Total ConversionsOR-Mobile_2018-01_Sales : or_mobile_cv_acquisition-forfait_2018-01: Total ConversionsSH-Mobile_2018-01_Sales : sh_mobile_cv_acquisition-offre-mobile_2018-01: Total ConversionsSH-Mobile_2018-01_Sales : sh_mobile_cv_acquisition-terminal _2018-01: Total ConversionsOR-FAI_2018-01_Sales : or_fai_cv_confirmation-acquisition-internet-fibre_2018-01: Total ConversionsOR-FAI_2018-01_Sales : or_fai_cv_confirmation-migration-xdsl-vers-fibre_2018-01: Total ConversionsOR-Open_2018-01_Sales : or_open_cv_acquisition-open-fibre_2018-05: Total ConversionsOR-Open_2018-01_Sales : or_open_cv_migration-open-xdsl-vers-fibre_2018-01: Total ConversionsOR-FAI_2018-01_Sales : or_fai_cv_confirmation-acquisition-internet-xdsl_2018-01: Total ConversionsOR-Open_2018-01_Sales : or_open_cv_acquisition-open-xdsl_2018-01: Total ConversionsSH-Mobile-Livebox_2018-01_Sales : sh_mobile-livebox_cv_acq-offre-convergente_2018-01: Total ConversionsSH-Box-Internet_2018-08_Sales : sh_box-internet_cv_confirmation-acquisition-internet-adsl_2018-08: Total ConversionsSH-Box-Internet_2018-08_Sales : sh_box-internet_cv_confirmation-acquisition-internet-fibre_2018-10: Total ConversionsFR Orange Internet22183140_tradelab_odr_pcc_multi-format-native1_cpm_mob_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20194.080.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_pcc_multi-format-native1_cpm_web_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20190.830.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_pcc_multi-format-native2_cpm_mob_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20195.290.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_pcc_multi-format-native2_cpm_web_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20194.570.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_pcc_multi-format-native3_cpm_mob_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20194.480.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_pcc_multi-format-native3_cpm_web_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20194.620.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_std_120x600_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms__or-fai_kpi1-acquisition-bb19/02/20191.540.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_std_160x600_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms__or-fai_kpi1-acquisition-bb19/02/201910.060.000.000.000.000.000.001.000.000.000.000.000.000.001.000.00FR Orange Internet22183140_tradelab_odr_std_1800x1000_cpm_web_dis-eve_rtg_npa_retargeting_dbm_1st-tms__or-fai_kpi1-acquisition-bb19/02/201910.210.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_std_300x250_cpm_mob_dis-iab_rtg_npa_retargeting_dbm_1st-tms__or-fai_kpi1-acquisition-bb19/02/201927.220.000.000.000.000.000.000.000.000.000.001.000.000.000.000.00", selenium.getText("css=table.preview-table:nth-of-type(1)"));
	 verifyTrue(selenium.isVisible("css=div.spliter"));
	 verifyEquals("FR Sosh Mobile22275335_tradelab_stvalentin_std_300x50_cpm_mob_dis-iab_prosp_npa_prospectionalgo_dbm_ _sosh_kpi4-terminaux-mobile_kpi4-terminaux-mobile19/02/20199.550.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22275335_tradelab_stvalentin_std_300x600_cpm_web_dis-iab_prosp_npa_profiling_dbm_2nd-tl_sosh_kpi4-terminaux-mobile19/02/20190.720.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22275335_tradelab_stvalentin_std_300x600_cpm_web_dis-iab_prosp_npa_profiling_dbm_3rd-classique_sosh_kpi4-terminaux-mobile19/02/2019162.900.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22275335_tradelab_stvalentin_std_300x600_cpm_web_dis-iab_prosp_npa_prospectionalgo_dbm_ _sosh_kpi4-terminaux-mobile_kpi4-terminaux-mobile19/02/201963.250.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22275335_tradelab_stvalentin_std_320x50_cpm_mob_dis-iab_prosp_npa_prospectionalgo_dbm_ _sosh_kpi4-terminaux-mobile_kpi4-terminaux-mobile19/02/201930.550.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22275335_tradelab_stvalentin_std_728x90_cpm_web_dis-iab_prosp_npa_profiling_dbm_2nd-tl_sosh_kpi4-terminaux-mobile19/02/20190.620.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22275335_tradelab_stvalentin_std_728x90_cpm_web_dis-iab_prosp_npa_profiling_dbm_3rd-classique_sosh_kpi4-terminaux-mobile19/02/2019124.150.000.000.000.004.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22275335_tradelab_stvalentin_std_728x90_cpm_web_dis-iab_prosp_npa_prospectionalgo_dbm_ _sosh_kpi4-terminaux-mobile_kpi4-terminaux-mobile19/02/201942.060.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22275335_tradelab_stvalentin_std_970x250_cpm_web_dis-eve_prosp_npa_profiling_dbm_2nd-tl_sosh_kpi4-terminaux-mobile_kpi4-terminaux-mobile19/02/20190.050.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22275335_tradelab_stvalentin_std_970x250_cpm_web_dis-eve_prosp_npa_profiling_dbm_3rd-classique_sosh_kpi4-terminaux-mobile_kpi4-terminaux-mobile19/02/20198.050.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00", selenium.getText("css=table.preview-table:nth-of-type(2)"));
	 selenium.click("css=document-setup > div > div > button:nth-of-type(3)")
	 selenium.if("${downloadReport} == 1")
	 String waitForReport = "5000"
	 String remainingAttempts = "40"
	 boolean canDownloadReport = selenium.isElementPresent("css=div.cdk-overlay-pane > div > div > button[aria-disabled=\"false\"]")
	 selenium.while(canDownloadReport + " == 0 && " + remainingAttempts + " > 0")
	 Thread.sleep(NaN);
	 selenium.refresh()
	 selenium.waitForPageToLoad("")
	 selenium.click("css=document-setup > div > div > button:nth-of-type(3)")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div.cdk-overlay-pane > div > div > button")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 boolean canDownloadReport = selenium.isElementPresent("css=div.cdk-overlay-pane > div > div > button[aria-disabled=\"false\"]")
	 String remainingAttempts = selenium.getEval("remainingAttempts - 1")
	 selenium.endWhile()
	 selenium.click("css=div.cdk-overlay-pane > div > div > button[aria-disabled=\"false\"]")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=snack-bar-container > simple-snack-bar")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.endIf()
	 }
	 @Keyword
	 public void nonCumulativeNormalCsv () {
	 // Create folder
	 createFolder("Test auto - Non-Cumulative - CSV Settings - Normal CSV")
	 // Cumulative iterations - CSV < 20 rows
	 String page = "folders"
	 selenium.if("\"${currentEnvironment}\" != \"prod\" && \"${currentEnvironment}\" != \"\"")
	 selenium.open("http://${currentEnvironment}-reportfolio-api.tradelab.fr/internals/commander/index.php")
	 selenium.waitForPageToLoad("")
	 assertTrue(selenium.isElementPresent("css=body > p > a > button"));
	 selenium.click("css=body > p > a > button")
	 selenium.waitForPageToLoad("30000")
	 String currentTime = selenium.getValue("css=#delta_interval")
	 selenium.if("\"" + currentTime + "\" != \"P0D\"")
	 selenium.type("css=#delta_interval", "P0D")
	 selenium.click("css=form > p > input[type=\"submit\"]")
	 selenium.waitForPageToLoad("30000")
	 selenium.endIf()
	 selenium.endIf()
	 selenium.open("http://${currentEnvironment}${tiret}${currentWebsite}/" + page)
	 Thread.sleep(2000);
	 selenium.click("css=button[id=\"button-new-report\"]")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=button[id=\"button-new-basic-report\"]")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=button[id=\"button-new-basic-report\"]")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div > mat-dialog-container")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=mat-dialog-content div.mat-form-field-flex > div > mat-select")
	 Thread.sleep(500);
	 selenium.click("css=div[class=\"cdk-overlay-pane\"] > div > mat-option:nth-child(1)")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div.mat-form-field-infix > input.mat-input-element")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.type("css=div.mat-form-field-infix > input.mat-input-element", "Test auto - Report - Cumulative iterations - CSV < 20 rows")
	 selenium.click("css=app-new-document-dialog > form > mat-dialog-actions > button.mat-raised-button.mat-accent > span")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=app-document > section > subreport > div > header > span")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 Thread.sleep(1500);
	 selenium.click("css=subreport > div > header > div > button > span > i")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div.mat-menu-content > button:nth-child(1)")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=div.mat-menu-content > button:nth-child(1)")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > i")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > i")
	 selenium.type("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > input", "Cumulative iterations - CSV < 20 rows Subreport")
	 selenium.fireEvent("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > input", "blur")
	 selenium.click("css=document-setup > mat-card > mat-card-content > div.option.schedule > button")
	 selenium.click("css=sat-datepicker-toggle > button")
	 selenium.click("css=.mat-calendar-body-today")
	 selenium.click("css=.mat-calendar-body-today")
	 selenium.click("css=document-scheduler > div.mat-dialog-actions > button.mat-raised-button.mat-accent")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (!selenium.isVisible("xpath=//*[text()='No report yet']")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.type("css=document-setup > mat-card > mat-card-content > div:nth-child(3) > form > button > span > input", "${templateFullPath}")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=document-setup > mat-card > mat-card-content > div:nth-child(3) > button:nth-of-type(2)")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=document-setup > mat-card > mat-card-content > div:nth-child(3) > button:nth-of-type(2)")
	 selenium.type("css=section.display-sheets > table > tbody > tr:nth-child(1) > td.mat-cell.cdk-column-xls_sheet_index.mat-column-xls_sheet_index.ng-star-inserted > input", "8")
	 System.out.println("ISSUE WITH OPTION css=section.display-sheets > table > tbody > tr:nth-child(1) > td:nth-of-type(4) > mat-checkbox > label > div");
	 selenium.click("css=section.display-sheets > table > tbody > tr:nth-child(1) > td:nth-of-type(5) > mat-checkbox > label > div")
	 selenium.fireEvent("css= td.cdk-column-xls_sheet_index.mat-column-xls_sheet_index > input", "change")
	 selenium.click("css=app-document-settings > mat-dialog-actions > button.mat-raised-button.mat-accent")
	 selenium.click("css=app-document > section > subreport > div > sheet > mat-card > div > div > button > span > span")
	 selenium.type("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div > div:nth-child(2) > div:nth-child(1) > input", "1")
	 selenium.type("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div > div:nth-child(2) > div:nth-child(2) > input", "0")
	 selenium.select("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div > div:nth-child(3) > div:nth-child(1) > select", "value=;")
	 selenium.click("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div:nth-child(2) > button")
	 Thread.sleep(1500);
	 selenium.refresh()
	 selenium.waitForPageToLoad("")
	 selenium.click("css=app-document > section > subreport > div > sheet > mat-card > div > div > button > span > span")
	 selenium.type("css=input#fileUpload", "${smallerCsvFullPath}")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div.preview-info")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 String currentDate = selenium.getEval("var today = new Date(); today.toISOString().substring(0,10);")
	 verifyEquals("CSV of iteration " + currentDate + " - Total rows : 7", selenium.getText("css=div.preview-info"));
	 assertEquals("First line of first CSVPlacementDateDBM Cost (Account Currency)OR-Mobile_2018-01_Sales : or_mobile_cv_acquisition-terminal _2018-01: Total ConversionsOR-Mobile_2018-01_Sales : or_mobile_cv_fidelisation-terminal_2018-01: Total ConversionsOR-Mobile_2018-01_Sales : or_mobile_cv_acquisition-forfait-multi-ligne_2018-01: Total ConversionsOR-Mobile_2018-01_Sales : or_mobile_cv_acquisition-forfait_2018-01: Total ConversionsSH-Mobile_2018-01_Sales : sh_mobile_cv_acquisition-offre-mobile_2018-01: Total ConversionsSH-Mobile_2018-01_Sales : sh_mobile_cv_acquisition-terminal _2018-01: Total ConversionsOR-FAI_2018-01_Sales : or_fai_cv_confirmation-acquisition-internet-fibre_2018-01: Total ConversionsOR-FAI_2018-01_Sales : or_fai_cv_confirmation-migration-xdsl-vers-fibre_2018-01: Total ConversionsOR-Open_2018-01_Sales : or_open_cv_acquisition-open-fibre_2018-05: Total ConversionsOR-Open_2018-01_Sales : or_open_cv_migration-open-xdsl-vers-fibre_2018-01: Total ConversionsOR-FAI_2018-01_Sales : or_fai_cv_confirmation-acquisition-internet-xdsl_2018-01: Total ConversionsOR-Open_2018-01_Sales : or_open_cv_acquisition-open-xdsl_2018-01: Total ConversionsSH-Mobile-Livebox_2018-01_Sales : sh_mobile-livebox_cv_acq-offre-convergente_2018-01: Total ConversionsSH-Box-Internet_2018-08_Sales : sh_box-internet_cv_confirmation-acquisition-internet-adsl_2018-08: Total ConversionsSH-Box-Internet_2018-08_Sales : sh_box-internet_cv_confirmation-acquisition-internet-fibre_2018-10: Total ConversionsFR Orange Internet22183140_tradelab_odr_pcc_multi-format-native1_cpm_mob_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20194.080.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_pcc_multi-format-native2_cpm_web_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20194.570.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_pcc_multi-format-native3_cpm_mob_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20194.480.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_320x480_cpm_mob_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/20192.280.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_728x90_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201990.440.000.000.000.004.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_970x250_cpm_web_dis-eve_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201912.950.000.000.000.000.001.000.000.000.000.000.000.000.000.000.00Last line of first CSV------13367.257.0029.008.0013.0051.0014.003.001.001.000.008.000.000.0011.009.00", selenium.getText("css=table.preview-table:nth-of-type(1)"));
	 String currentReportUrl = selenium.getEval("document.location.href")
	 selenium.click("css=document-setup > div > div > button:nth-of-type(3)")
	 selenium.if("${downloadReport} == 1")
	 String waitForReport = "5000"
	 String remainingAttempts = "40"
	 boolean canDownloadReport = selenium.isElementPresent("css=div.cdk-overlay-pane > div > div > button[aria-disabled=\"false\"]")
	 selenium.while(canDownloadReport + " == 0 && " + remainingAttempts + " > 0")
	 Thread.sleep(NaN);
	 selenium.refresh()
	 selenium.waitForPageToLoad("")
	 selenium.click("css=document-setup > div > div > button:nth-of-type(3)")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div.cdk-overlay-pane > div > div > button")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 boolean canDownloadReport = selenium.isElementPresent("css=div.cdk-overlay-pane > div > div > button[aria-disabled=\"false\"]")
	 String remainingAttempts = selenium.getEval("remainingAttempts - 1")
	 selenium.endWhile()
	 selenium.click("css=div.cdk-overlay-pane > div > div > button[aria-disabled=\"false\"]")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=snack-bar-container > simple-snack-bar")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.endIf()
	 selenium.if("\"${currentEnvironment}\" != \"prod\" && \"${currentEnvironment}\" != \"\"")
	 selenium.open("http://${currentEnvironment}-reportfolio-api.tradelab.fr/internals/commander/index.php")
	 selenium.waitForPageToLoad("")
	 assertTrue(selenium.isElementPresent("css=body > p > a > button"));
	 selenium.click("css=body > p > a > button")
	 selenium.waitForPageToLoad("30000")
	 String currentTime = selenium.getValue("css=#delta_interval")
	 selenium.if("\"" + currentTime + "\" != \"P0D\"")
	 selenium.type("css=#delta_interval", "P0D")
	 selenium.click("css=form > p > input[type=\"submit\"]")
	 selenium.waitForPageToLoad("30000")
	 selenium.endIf()
	 selenium.endIf()
	 selenium.open(currentReportUrl)
	 // Cumulative iterations - CSV > 20 rows
	 String page = "folders"
	 selenium.if("\"${currentEnvironment}\" != \"prod\" && \"${currentEnvironment}\" != \"\"")
	 selenium.open("http://${currentEnvironment}-reportfolio-api.tradelab.fr/internals/commander/index.php")
	 selenium.waitForPageToLoad("")
	 assertTrue(selenium.isElementPresent("css=body > p > a > button"));
	 selenium.click("css=body > p > a > button")
	 selenium.waitForPageToLoad("30000")
	 String currentTime = selenium.getValue("css=#delta_interval")
	 selenium.if("\"" + currentTime + "\" != \"P0D\"")
	 selenium.type("css=#delta_interval", "P0D")
	 selenium.click("css=form > p > input[type=\"submit\"]")
	 selenium.waitForPageToLoad("30000")
	 selenium.endIf()
	 selenium.open("http://${currentEnvironment}${tiret}${currentWebsite}/" + page)
	 Thread.sleep(2000);
	 selenium.click("css=button[id=\"button-new-report\"]")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=button[id=\"button-new-basic-report\"]")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=button[id=\"button-new-basic-report\"]")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div > mat-dialog-container")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=mat-dialog-content div.mat-form-field-flex > div > mat-select")
	 Thread.sleep(500);
	 selenium.click("css=div[class=\"cdk-overlay-pane\"] > div > mat-option:nth-child(1)")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div.mat-form-field-infix > input.mat-input-element")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.type("css=div.mat-form-field-infix > input.mat-input-element", "Test auto - Report - Cumulative iterations - CSV > 20 rows")
	 selenium.click("css=app-new-document-dialog > form > mat-dialog-actions > button.mat-raised-button.mat-accent > span")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=app-document > section > subreport > div > header > span")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 Thread.sleep(1500);
	 selenium.click("css=subreport > div > header > div > button > span > i")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div.mat-menu-content > button:nth-child(1)")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=div.mat-menu-content > button:nth-child(1)")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > i")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > i")
	 selenium.type("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > input", "Cumulative iterations - CSV > 20 rows Subreport")
	 selenium.fireEvent("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > input", "blur")
	 selenium.click("css=document-setup > mat-card > mat-card-content > div.option.schedule > button")
	 selenium.click("css=sat-datepicker-toggle > button")
	 selenium.click("css=.mat-calendar-body-today")
	 selenium.click("css=.mat-calendar-body-today")
	 selenium.click("css=document-scheduler > div.mat-dialog-actions > button.mat-raised-button.mat-accent")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (!selenium.isVisible("xpath=//*[text()='No report yet']")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.type("css=document-setup > mat-card > mat-card-content > div:nth-child(3) > form > button > span > input", "${templateFullPath}")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=document-setup > mat-card > mat-card-content > div:nth-child(3) > button:nth-of-type(2)")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=document-setup > mat-card > mat-card-content > div:nth-child(3) > button:nth-of-type(2)")
	 selenium.type("css=section.display-sheets > table > tbody > tr:nth-child(1) > td.mat-cell.cdk-column-xls_sheet_index.mat-column-xls_sheet_index.ng-star-inserted > input", "8")
	 System.out.println("ISSUE WITH OPTION css=section.display-sheets > table > tbody > tr:nth-child(1) > td:nth-of-type(4) > mat-checkbox > label > div");
	 selenium.click("css=section.display-sheets > table > tbody > tr:nth-child(1) > td:nth-of-type(5) > mat-checkbox > label > div")
	 selenium.fireEvent("css= td.cdk-column-xls_sheet_index.mat-column-xls_sheet_index > input", "change")
	 selenium.click("css=app-document-settings > mat-dialog-actions > button.mat-raised-button.mat-accent")
	 selenium.click("css=app-document > section > subreport > div > sheet > mat-card > div > div > button > span > span")
	 selenium.type("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div > div:nth-child(2) > div:nth-child(1) > input", "1")
	 selenium.type("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div > div:nth-child(2) > div:nth-child(2) > input", "0")
	 selenium.select("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div > div:nth-child(3) > div:nth-child(1) > select", "value=;")
	 selenium.click("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div:nth-child(2) > button")
	 Thread.sleep(1500);
	 selenium.refresh()
	 selenium.waitForPageToLoad("")
	 selenium.click("css=app-document > section > subreport > div > sheet > mat-card > div > div > button > span > span")
	 selenium.type("css=input#fileUpload", "${biggerCsvFullPath}")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div.preview-info")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 String currentDate = selenium.getEval("var today = new Date(); today.toISOString().substring(0,10);")
	 verifyEquals("CSV of iteration " + currentDate + " - Total rows : 807", selenium.getText("css=div.preview-info"));
	 assertEquals("First line of first CSVDate/Time Generated2/20/19 4:39 AMReport Time ZoneEurope/ParisAccount ID743372Date Range2/19/19 - 2/19/19AdvertiserEquals:FR Orange Internet (8364571)AdvertiserEquals:FR Orange Mobile (8365738)AdvertiserEquals:FR Sosh Internet (8364841)AdvertiserEquals:FR Sosh Mobile (8364118)MRC Accredited MetricsNoneReport Fields", selenium.getText("css=table.preview-table:nth-of-type(1)"));
	 verifyTrue(selenium.isVisible("css=div.spliter"));
	 verifyEquals("FR Sosh Mobile22330690_tradelab_terminaux_std_160x600_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201931.520.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_300x250_cpm_mob_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201919.710.000.000.000.000.001.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_300x250_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/2019161.630.000.000.000.004.001.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_300x50_cpm_mob_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/20199.980.000.000.000.000.000.000.000.000.000.000.000.000.001.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_300x600_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/2019130.010.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_320x480_cpm_mob_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/20192.280.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_320x50_cpm_mob_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201910.450.000.000.000.000.001.000.000.000.000.000.000.000.000.001.00FR Sosh Mobile22330690_tradelab_terminaux_std_728x90_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201990.440.000.000.000.004.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_970x250_cpm_web_dis-eve_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201912.950.000.000.000.000.001.000.000.000.000.000.000.000.000.000.00Last line of first CSV------13367.257.0029.008.0013.0051.0014.003.001.001.000.008.000.000.0011.009.00", selenium.getText("css=table.preview-table:nth-of-type(2)"));
	 String currentReportUrl = selenium.getEval("document.location.href")
	 selenium.click("css=document-setup > div > div > button:nth-of-type(3)")
	 selenium.if("${downloadReport} == 1")
	 String waitForReport = "5000"
	 String remainingAttempts = "40"
	 boolean canDownloadReport = selenium.isElementPresent("css=div.cdk-overlay-pane > div > div > button[aria-disabled=\"false\"]")
	 selenium.while(canDownloadReport + " == 0 && " + remainingAttempts + " > 0")
	 Thread.sleep(NaN);
	 selenium.refresh()
	 selenium.waitForPageToLoad("")
	 selenium.click("css=document-setup > div > div > button:nth-of-type(3)")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div.cdk-overlay-pane > div > div > button")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 boolean canDownloadReport = selenium.isElementPresent("css=div.cdk-overlay-pane > div > div > button[aria-disabled=\"false\"]")
	 String remainingAttempts = selenium.getEval("remainingAttempts - 1")
	 selenium.endWhile()
	 selenium.click("css=div.cdk-overlay-pane > div > div > button[aria-disabled=\"false\"]")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=snack-bar-container > simple-snack-bar")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.endIf()
	 selenium.if("\"${currentEnvironment}\" != \"prod\" && \"${currentEnvironment}\" != \"\"")
	 selenium.open("http://${currentEnvironment}-reportfolio-api.tradelab.fr/internals/commander/index.php")
	 selenium.waitForPageToLoad("")
	 assertTrue(selenium.isElementPresent("css=body > p > a > button"));
	 selenium.click("css=body > p > a > button")
	 selenium.waitForPageToLoad("30000")
	 String currentTime = selenium.getValue("css=#delta_interval")
	 selenium.if("\"" + currentTime + "\" != \"P0D\"")
	 selenium.type("css=#delta_interval", "P0D")
	 selenium.click("css=form > p > input[type=\"submit\"]")
	 selenium.waitForPageToLoad("30000")
	 selenium.endIf()
	 selenium.endIf()
	 selenium.open(currentReportUrl)
	 Thread.sleep(2000);
	 // Start from row 2
	 selenium.click("css=button[id=\"button-new-report\"]")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=button[id=\"button-new-basic-report\"]")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=button[id=\"button-new-basic-report\"]")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div > mat-dialog-container")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=mat-dialog-content div.mat-form-field-flex > div > mat-select")
	 Thread.sleep(500);
	 selenium.click("css=div[class=\"cdk-overlay-pane\"] > div > mat-option:nth-child(1)")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div.mat-form-field-infix > input.mat-input-element")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.type("css=div.mat-form-field-infix > input.mat-input-element", "Test auto - Report - Start from row 2")
	 selenium.click("css=app-new-document-dialog > form > mat-dialog-actions > button.mat-raised-button.mat-accent > span")
	 Thread.sleep(1000);
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (!selenium.isVisible("css=div.preview-info")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=subreport > div > header > div > button > span > i")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div.mat-menu-content > button:nth-child(1)")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=div.mat-menu-content > button:nth-child(1)")
	 Thread.sleep(1500);
	 boolean isSubreportCreated = selenium.isElementPresent("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > i")
	 selenium.if(isSubreportCreated + " == 0")
	 selenium.click("css=div.mat-menu-content > button:nth-of-type(1)")
	 selenium.endIf()
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > i")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > i")
	 selenium.type("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > input", "Start from row Subreport")
	 selenium.fireEvent("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > input", "blur")
	 selenium.click("css=document-setup > mat-card > mat-card-content > div.option.schedule > button")
	 selenium.click("css=sat-datepicker-toggle > button")
	 selenium.click("css=.mat-calendar-body-today")
	 selenium.click("css=.mat-calendar-body-today")
	 selenium.click("css=document-scheduler > div.mat-dialog-actions > button.mat-raised-button.mat-accent")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (!selenium.isVisible("xpath=//*[text()='No report yet']")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.type("css=document-setup > mat-card > mat-card-content > div:nth-child(3) > form > button > span > input", "${templateFullPath}")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=document-setup > mat-card > mat-card-content > div:nth-child(3) > button:nth-of-type(2)")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=document-setup > mat-card > mat-card-content > div:nth-child(3) > button:nth-of-type(2)")
	 selenium.type("css=section.display-sheets > table > tbody > tr:nth-child(1) > td.mat-cell.cdk-column-xls_sheet_index.mat-column-xls_sheet_index.ng-star-inserted > input", "8")
	 System.out.println("ISSUE WITH OPTION css=section.display-sheets > table > tbody > tr:nth-child(1) > td:nth-of-type(4) > mat-checkbox > label > div");
	 selenium.click("css=section.display-sheets > table > tbody > tr:nth-child(1) > td:nth-of-type(5) > mat-checkbox > label > div")
	 selenium.fireEvent("css= td.cdk-column-xls_sheet_index.mat-column-xls_sheet_index > input", "change")
	 selenium.click("css=app-document-settings > mat-dialog-actions > button.mat-raised-button.mat-accent")
	 selenium.click("css=app-document > section > subreport > div > sheet > mat-card > div > div > button > span > span")
	 selenium.type("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div > div:nth-child(2) > div:nth-child(1) > input", "2")
	 selenium.select("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div > div:nth-child(3) > div:nth-child(1) > select", "value=;")
	 selenium.click("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div:nth-child(2) > button")
	 Thread.sleep(1500);
	 selenium.refresh()
	 selenium.waitForPageToLoad("")
	 selenium.click("css=app-document > section > subreport > div > sheet > mat-card > div > div > button > span > span")
	 selenium.type("css=input#fileUpload", "${biggerCsvFullPath}")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div.preview-info")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 String currentDate = selenium.getEval("var today = new Date(); today.toISOString().substring(0,10);")
	 verifyEquals("CSV of iteration " + currentDate + " - Total rows : 806", selenium.getText("css=div.preview-info"));
	 assertEquals("Date/Time Generated2/20/19 4:39 AMReport Time ZoneEurope/ParisAccount ID743372Date Range2/19/19 - 2/19/19AdvertiserEquals:FR Orange Internet (8364571)AdvertiserEquals:FR Orange Mobile (8365738)AdvertiserEquals:FR Sosh Internet (8364841)AdvertiserEquals:FR Sosh Mobile (8364118)MRC Accredited MetricsNoneReport FieldsHeader of first CSV at line 12PlacementDateDBM Cost (Account Currency)OR-Mobile_2018-01_Sales : or_mobile_cv_acquisition-terminal _2018-01: Total ConversionsOR-Mobile_2018-01_Sales : or_mobile_cv_fidelisation-terminal_2018-01: Total ConversionsOR-Mobile_2018-01_Sales : or_mobile_cv_acquisition-forfait-multi-ligne_2018-01: Total ConversionsOR-Mobile_2018-01_Sales : or_mobile_cv_acquisition-forfait_2018-01: Total ConversionsSH-Mobile_2018-01_Sales : sh_mobile_cv_acquisition-offre-mobile_2018-01: Total ConversionsSH-Mobile_2018-01_Sales : sh_mobile_cv_acquisition-terminal _2018-01: Total ConversionsOR-FAI_2018-01_Sales : or_fai_cv_confirmation-acquisition-internet-fibre_2018-01: Total ConversionsOR-FAI_2018-01_Sales : or_fai_cv_confirmation-migration-xdsl-vers-fibre_2018-01: Total ConversionsOR-Open_2018-01_Sales : or_open_cv_acquisition-open-fibre_2018-05: Total ConversionsOR-Open_2018-01_Sales : or_open_cv_migration-open-xdsl-vers-fibre_2018-01: Total ConversionsOR-FAI_2018-01_Sales : or_fai_cv_confirmation-acquisition-internet-xdsl_2018-01: Total ConversionsOR-Open_2018-01_Sales : or_open_cv_acquisition-open-xdsl_2018-01: Total ConversionsSH-Mobile-Livebox_2018-01_Sales : sh_mobile-livebox_cv_acq-offre-convergente_2018-01: Total ConversionsSH-Box-Internet_2018-08_Sales : sh_box-internet_cv_confirmation-acquisition-internet-adsl_2018-08: Total ConversionsSH-Box-Internet_2018-08_Sales : sh_box-internet_cv_confirmation-acquisition-internet-fibre_2018-10: Total Conversions", selenium.getText("css=table.preview-table:nth-of-type(1)"));
	 verifyTrue(selenium.isVisible("css=div.spliter"));
	 verifyEquals("FR Sosh Mobile22330690_tradelab_terminaux_std_160x600_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201931.520.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_300x250_cpm_mob_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201919.710.000.000.000.000.001.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_300x250_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/2019161.630.000.000.000.004.001.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_300x50_cpm_mob_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/20199.980.000.000.000.000.000.000.000.000.000.000.000.000.001.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_300x600_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/2019130.010.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_320x480_cpm_mob_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/20192.280.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_320x50_cpm_mob_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201910.450.000.000.000.000.001.000.000.000.000.000.000.000.000.001.00FR Sosh Mobile22330690_tradelab_terminaux_std_728x90_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201990.440.000.000.000.004.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_970x250_cpm_web_dis-eve_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201912.950.000.000.000.000.001.000.000.000.000.000.000.000.000.000.00Last line of first CSV------13367.257.0029.008.0013.0051.0014.003.001.001.000.008.000.000.0011.009.00", selenium.getText("css=table.preview-table:nth-of-type(2)"));
	 selenium.click("css=document-setup > div > div > button:nth-of-type(3)")
	 selenium.if("${downloadReport} == 1")
	 String waitForReport = "5000"
	 String remainingAttempts = "40"
	 boolean canDownloadReport = selenium.isElementPresent("css=div.cdk-overlay-pane > div > div > button[aria-disabled=\"false\"]")
	 selenium.while(canDownloadReport + " == 0 && " + remainingAttempts + " > 0")
	 Thread.sleep(NaN);
	 selenium.refresh()
	 selenium.waitForPageToLoad("")
	 selenium.click("css=document-setup > div > div > button:nth-of-type(3)")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div.cdk-overlay-pane > div > div > button")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 boolean canDownloadReport = selenium.isElementPresent("css=div.cdk-overlay-pane > div > div > button[aria-disabled=\"false\"]")
	 String remainingAttempts = selenium.getEval("remainingAttempts - 1")
	 selenium.endWhile()
	 selenium.click("css=div.cdk-overlay-pane > div > div > button[aria-disabled=\"false\"]")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=snack-bar-container > simple-snack-bar")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.endIf()
	 // Start from row 12
	 selenium.click("css=button[id=\"button-new-report\"]")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=button[id=\"button-new-basic-report\"]")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=button[id=\"button-new-basic-report\"]")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div > mat-dialog-container")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=mat-dialog-content div.mat-form-field-flex > div > mat-select")
	 Thread.sleep(500);
	 selenium.click("css=div[class=\"cdk-overlay-pane\"] > div > mat-option:nth-child(1)")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div.mat-form-field-infix > input.mat-input-element")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.type("css=div.mat-form-field-infix > input.mat-input-element", "Test auto - Report - Start from row 12")
	 selenium.click("css=app-new-document-dialog > form > mat-dialog-actions > button.mat-raised-button.mat-accent > span")
	 Thread.sleep(1000);
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (!selenium.isVisible("css=div.preview-info")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=subreport > div > header > div > button > span > i")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div.mat-menu-content > button:nth-child(1)")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=div.mat-menu-content > button:nth-child(1)")
	 Thread.sleep(1500);
	 boolean isSubreportCreated = selenium.isElementPresent("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > i")
	 selenium.if(isSubreportCreated + " == 0")
	 selenium.click("css=div.mat-menu-content > button:nth-of-type(1)")
	 selenium.endIf()
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > i")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > i")
	 selenium.type("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > input", "Start from row 12 Subreport")
	 selenium.fireEvent("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > input", "blur")
	 selenium.click("css=document-setup > mat-card > mat-card-content > div.option.schedule > button")
	 selenium.click("css=sat-datepicker-toggle > button")
	 selenium.click("css=.mat-calendar-body-today")
	 selenium.click("css=.mat-calendar-body-today")
	 selenium.click("css=document-scheduler > div.mat-dialog-actions > button.mat-raised-button.mat-accent")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (!selenium.isVisible("xpath=//*[text()='No report yet']")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.type("css=document-setup > mat-card > mat-card-content > div:nth-child(3) > form > button > span > input", "${templateFullPath}")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=document-setup > mat-card > mat-card-content > div:nth-child(3) > button:nth-of-type(2)")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=document-setup > mat-card > mat-card-content > div:nth-child(3) > button:nth-of-type(2)")
	 selenium.type("css=section.display-sheets > table > tbody > tr:nth-child(1) > td.mat-cell.cdk-column-xls_sheet_index.mat-column-xls_sheet_index.ng-star-inserted > input", "8")
	 System.out.println("ISSUE WITH OPTION css=section.display-sheets > table > tbody > tr:nth-child(1) > td:nth-of-type(4) > mat-checkbox > label > div");
	 selenium.click("css=section.display-sheets > table > tbody > tr:nth-child(1) > td:nth-of-type(5) > mat-checkbox > label > div")
	 selenium.fireEvent("css= td.cdk-column-xls_sheet_index.mat-column-xls_sheet_index > input", "change")
	 selenium.click("css=app-document-settings > mat-dialog-actions > button.mat-raised-button.mat-accent")
	 selenium.click("css=app-document > section > subreport > div > sheet > mat-card > div > div > button > span > span")
	 selenium.type("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div > div:nth-child(2) > div:nth-child(1) > input", "12")
	 selenium.select("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div > div:nth-child(3) > div:nth-child(1) > select", "value=;")
	 selenium.click("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div:nth-child(2) > button")
	 Thread.sleep(1500);
	 selenium.refresh()
	 selenium.waitForPageToLoad("")
	 selenium.click("css=app-document > section > subreport > div > sheet > mat-card > div > div > button > span > span")
	 selenium.type("css=input#fileUpload", "${biggerCsvFullPath}")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div.preview-info")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 String currentDate = selenium.getEval("var today = new Date(); today.toISOString().substring(0,10);")
	 verifyEquals("CSV of iteration " + currentDate + " - Total rows : 796", selenium.getText("css=div.preview-info"));
	 assertEquals("Header of first CSV at line 12PlacementDateDBM Cost (Account Currency)OR-Mobile_2018-01_Sales : or_mobile_cv_acquisition-terminal _2018-01: Total ConversionsOR-Mobile_2018-01_Sales : or_mobile_cv_fidelisation-terminal_2018-01: Total ConversionsOR-Mobile_2018-01_Sales : or_mobile_cv_acquisition-forfait-multi-ligne_2018-01: Total ConversionsOR-Mobile_2018-01_Sales : or_mobile_cv_acquisition-forfait_2018-01: Total ConversionsSH-Mobile_2018-01_Sales : sh_mobile_cv_acquisition-offre-mobile_2018-01: Total ConversionsSH-Mobile_2018-01_Sales : sh_mobile_cv_acquisition-terminal _2018-01: Total ConversionsOR-FAI_2018-01_Sales : or_fai_cv_confirmation-acquisition-internet-fibre_2018-01: Total ConversionsOR-FAI_2018-01_Sales : or_fai_cv_confirmation-migration-xdsl-vers-fibre_2018-01: Total ConversionsOR-Open_2018-01_Sales : or_open_cv_acquisition-open-fibre_2018-05: Total ConversionsOR-Open_2018-01_Sales : or_open_cv_migration-open-xdsl-vers-fibre_2018-01: Total ConversionsOR-FAI_2018-01_Sales : or_fai_cv_confirmation-acquisition-internet-xdsl_2018-01: Total ConversionsOR-Open_2018-01_Sales : or_open_cv_acquisition-open-xdsl_2018-01: Total ConversionsSH-Mobile-Livebox_2018-01_Sales : sh_mobile-livebox_cv_acq-offre-convergente_2018-01: Total ConversionsSH-Box-Internet_2018-08_Sales : sh_box-internet_cv_confirmation-acquisition-internet-adsl_2018-08: Total ConversionsSH-Box-Internet_2018-08_Sales : sh_box-internet_cv_confirmation-acquisition-internet-fibre_2018-10: Total ConversionsFR Orange Internet22183140_tradelab_odr_pcc_multi-format-native1_cpm_mob_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20194.080.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_pcc_multi-format-native1_cpm_web_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20190.830.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_pcc_multi-format-native2_cpm_mob_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20195.290.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_pcc_multi-format-native2_cpm_web_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20194.570.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_pcc_multi-format-native3_cpm_mob_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20194.480.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_pcc_multi-format-native3_cpm_web_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20194.620.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_std_120x600_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms__or-fai_kpi1-acquisition-bb19/02/20191.540.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_std_160x600_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms__or-fai_kpi1-acquisition-bb19/02/201910.060.000.000.000.000.000.001.000.000.000.000.000.000.001.000.00FR Orange Internet22183140_tradelab_odr_std_1800x1000_cpm_web_dis-eve_rtg_npa_retargeting_dbm_1st-tms__or-fai_kpi1-acquisition-bb19/02/201910.210.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_std_300x250_cpm_mob_dis-iab_rtg_npa_retargeting_dbm_1st-tms__or-fai_kpi1-acquisition-bb19/02/201927.220.000.000.000.000.000.000.000.000.000.001.000.000.000.000.00", selenium.getText("css=table.preview-table:nth-of-type(1)"));
	 verifyTrue(selenium.isVisible("css=div.spliter"));
	 verifyEquals("FR Sosh Mobile22330690_tradelab_terminaux_std_160x600_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201931.520.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_300x250_cpm_mob_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201919.710.000.000.000.000.001.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_300x250_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/2019161.630.000.000.000.004.001.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_300x50_cpm_mob_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/20199.980.000.000.000.000.000.000.000.000.000.000.000.000.001.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_300x600_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/2019130.010.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_320x480_cpm_mob_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/20192.280.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_320x50_cpm_mob_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201910.450.000.000.000.000.001.000.000.000.000.000.000.000.000.001.00FR Sosh Mobile22330690_tradelab_terminaux_std_728x90_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201990.440.000.000.000.004.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_970x250_cpm_web_dis-eve_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201912.950.000.000.000.000.001.000.000.000.000.000.000.000.000.000.00Last line of first CSV------13367.257.0029.008.0013.0051.0014.003.001.001.000.008.000.000.0011.009.00", selenium.getText("css=table.preview-table:nth-of-type(2)"));
	 selenium.click("css=document-setup > div > div > button:nth-of-type(3)")
	 selenium.if("${downloadReport} == 1")
	 String waitForReport = "5000"
	 String remainingAttempts = "40"
	 boolean canDownloadReport = selenium.isElementPresent("css=div.cdk-overlay-pane > div > div > button[aria-disabled=\"false\"]")
	 selenium.while(canDownloadReport + " == 0 && " + remainingAttempts + " > 0")
	 Thread.sleep(NaN);
	 selenium.refresh()
	 selenium.waitForPageToLoad("")
	 selenium.click("css=document-setup > div > div > button:nth-of-type(3)")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div.cdk-overlay-pane > div > div > button")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 boolean canDownloadReport = selenium.isElementPresent("css=div.cdk-overlay-pane > div > div > button[aria-disabled=\"false\"]")
	 String remainingAttempts = selenium.getEval("remainingAttempts - 1")
	 selenium.endWhile()
	 selenium.click("css=div.cdk-overlay-pane > div > div > button[aria-disabled=\"false\"]")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=snack-bar-container > simple-snack-bar")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.endIf()
	 // Exclude last 2
	 selenium.click("css=button[id=\"button-new-report\"]")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=button[id=\"button-new-basic-report\"]")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=button[id=\"button-new-basic-report\"]")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div > mat-dialog-container")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=mat-dialog-content div.mat-form-field-flex > div > mat-select")
	 Thread.sleep(500);
	 selenium.click("css=div[class=\"cdk-overlay-pane\"] > div > mat-option:nth-child(1)")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div.mat-form-field-infix > input.mat-input-element")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.type("css=div.mat-form-field-infix > input.mat-input-element", "Test auto - Report - Exclude last 2")
	 selenium.click("css=app-new-document-dialog > form > mat-dialog-actions > button.mat-raised-button.mat-accent > span")
	 Thread.sleep(1000);
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (!selenium.isVisible("css=div.preview-info")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=subreport > div > header > div > button > span > i")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div.mat-menu-content > button:nth-child(1)")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=div.mat-menu-content > button:nth-child(1)")
	 Thread.sleep(1500);
	 boolean isSubreportCreated = selenium.isElementPresent("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > i")
	 selenium.if(isSubreportCreated + " == 0")
	 selenium.click("css=div.mat-menu-content > button:nth-of-type(1)")
	 selenium.endIf()
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > i")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > i")
	 selenium.type("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > input", "Exclude last Subreport")
	 selenium.fireEvent("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > input", "blur")
	 selenium.click("css=document-setup > mat-card > mat-card-content > div.option.schedule > button")
	 selenium.click("css=sat-datepicker-toggle > button")
	 selenium.click("css=.mat-calendar-body-today")
	 selenium.click("css=.mat-calendar-body-today")
	 selenium.click("css=document-scheduler > div.mat-dialog-actions > button.mat-raised-button.mat-accent")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (!selenium.isVisible("xpath=//*[text()='No report yet']")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.type("css=document-setup > mat-card > mat-card-content > div:nth-child(3) > form > button > span > input", "${templateFullPath}")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=document-setup > mat-card > mat-card-content > div:nth-child(3) > button:nth-of-type(2)")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=document-setup > mat-card > mat-card-content > div:nth-child(3) > button:nth-of-type(2)")
	 selenium.type("css=section.display-sheets > table > tbody > tr:nth-child(1) > td.mat-cell.cdk-column-xls_sheet_index.mat-column-xls_sheet_index.ng-star-inserted > input", "8")
	 System.out.println("ISSUE WITH OPTION css=section.display-sheets > table > tbody > tr:nth-child(1) > td:nth-of-type(4) > mat-checkbox > label > div");
	 selenium.click("css=section.display-sheets > table > tbody > tr:nth-child(1) > td:nth-of-type(5) > mat-checkbox > label > div")
	 selenium.fireEvent("css= td.cdk-column-xls_sheet_index.mat-column-xls_sheet_index > input", "change")
	 selenium.click("css=app-document-settings > mat-dialog-actions > button.mat-raised-button.mat-accent")
	 selenium.click("css=app-document > section > subreport > div > sheet > mat-card > div > div > button > span > span")
	 selenium.type("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div > div:nth-child(2) > div:nth-child(2) > input", "2")
	 selenium.select("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div > div:nth-child(3) > div:nth-child(1) > select", "value=;")
	 selenium.click("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div:nth-child(2) > button")
	 Thread.sleep(1500);
	 selenium.refresh()
	 selenium.waitForPageToLoad("")
	 selenium.click("css=app-document > section > subreport > div > sheet > mat-card > div > div > button > span > span")
	 selenium.type("css=input#fileUpload", "${biggerCsvFullPath}")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div.preview-info")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 String currentDate = selenium.getEval("var today = new Date(); today.toISOString().substring(0,10);")
	 verifyEquals("CSV of iteration " + currentDate + " - Total rows : 805", selenium.getText("css=div.preview-info"));
	 assertEquals("First line of first CSVDate/Time Generated2/20/19 4:39 AMReport Time ZoneEurope/ParisAccount ID743372Date Range2/19/19 - 2/19/19AdvertiserEquals:FR Orange Internet (8364571)AdvertiserEquals:FR Orange Mobile (8365738)AdvertiserEquals:FR Sosh Internet (8364841)AdvertiserEquals:FR Sosh Mobile (8364118)MRC Accredited MetricsNoneReport Fields", selenium.getText("css=table.preview-table:nth-of-type(1)"));
	 verifyTrue(selenium.isVisible("css=div.spliter"));
	 verifyEquals("FR Sosh Mobile22275335_tradelab_stvalentin_std_970x250_cpm_web_dis-eve_prosp_npa_prospectionalgo_dbm_ _sosh_kpi4-terminaux-mobile_kpi4-terminaux-mobile19/02/20195.870.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_120x600_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/20198.100.000.000.000.002.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_160x600_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201931.520.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_300x250_cpm_mob_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201919.710.000.000.000.000.001.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_300x250_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/2019161.630.000.000.000.004.001.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_300x50_cpm_mob_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/20199.980.000.000.000.000.000.000.000.000.000.000.000.000.001.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_300x600_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/2019130.010.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_320x480_cpm_mob_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/20192.280.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22330690_tradelab_terminaux_std_320x50_cpm_mob_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201910.450.000.000.000.000.001.000.000.000.000.000.000.000.000.001.00FR Sosh Mobile22330690_tradelab_terminaux_std_728x90_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms_sosh_kpi4-terminaux-mobile19/02/201990.440.000.000.000.004.000.000.000.000.000.000.000.000.000.000.00", selenium.getText("css=table.preview-table:nth-of-type(2)"));
	 selenium.click("css=document-setup > div > div > button:nth-of-type(3)")
	 selenium.if("${downloadReport} == 1")
	 String waitForReport = "5000"
	 String remainingAttempts = "40"
	 boolean canDownloadReport = selenium.isElementPresent("css=div.cdk-overlay-pane > div > div > button[aria-disabled=\"false\"]")
	 selenium.while(canDownloadReport + " == 0 && " + remainingAttempts + " > 0")
	 Thread.sleep(NaN);
	 selenium.refresh()
	 selenium.waitForPageToLoad("")
	 selenium.click("css=document-setup > div > div > button:nth-of-type(3)")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div.cdk-overlay-pane > div > div > button")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 boolean canDownloadReport = selenium.isElementPresent("css=div.cdk-overlay-pane > div > div > button[aria-disabled=\"false\"]")
	 String remainingAttempts = selenium.getEval("remainingAttempts - 1")
	 selenium.endWhile()
	 selenium.click("css=div.cdk-overlay-pane > div > div > button[aria-disabled=\"false\"]")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=snack-bar-container > simple-snack-bar")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.endIf()
	 // Exclude last 12
	 selenium.click("css=button[id=\"button-new-report\"]")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=button[id=\"button-new-basic-report\"]")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=button[id=\"button-new-basic-report\"]")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div > mat-dialog-container")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=mat-dialog-content div.mat-form-field-flex > div > mat-select")
	 Thread.sleep(500);
	 selenium.click("css=div[class=\"cdk-overlay-pane\"] > div > mat-option:nth-child(1)")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div.mat-form-field-infix > input.mat-input-element")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.type("css=div.mat-form-field-infix > input.mat-input-element", "Test auto - Report - Exclude last 12")
	 selenium.click("css=app-new-document-dialog > form > mat-dialog-actions > button.mat-raised-button.mat-accent > span")
	 Thread.sleep(1000);
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (!selenium.isVisible("css=div.preview-info")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=subreport > div > header > div > button > span > i")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div.mat-menu-content > button:nth-child(1)")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=div.mat-menu-content > button:nth-child(1)")
	 Thread.sleep(1500);
	 boolean isSubreportCreated = selenium.isElementPresent("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > i")
	 selenium.if(isSubreportCreated + " == 0")
	 selenium.click("css=div.mat-menu-content > button:nth-of-type(1)")
	 selenium.endIf()
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > i")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > i")
	 selenium.type("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > input", "Exclude last Subreport")
	 selenium.fireEvent("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > input", "blur")
	 selenium.click("css=document-setup > mat-card > mat-card-content > div.option.schedule > button")
	 selenium.click("css=sat-datepicker-toggle > button")
	 selenium.click("css=.mat-calendar-body-today")
	 selenium.click("css=.mat-calendar-body-today")
	 selenium.click("css=document-scheduler > div.mat-dialog-actions > button.mat-raised-button.mat-accent")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (!selenium.isVisible("xpath=//*[text()='No report yet']")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.type("css=document-setup > mat-card > mat-card-content > div:nth-child(3) > form > button > span > input", "${templateFullPath}")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=document-setup > mat-card > mat-card-content > div:nth-child(3) > button:nth-of-type(2)")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=document-setup > mat-card > mat-card-content > div:nth-child(3) > button:nth-of-type(2)")
	 selenium.type("css=section.display-sheets > table > tbody > tr:nth-child(1) > td.mat-cell.cdk-column-xls_sheet_index.mat-column-xls_sheet_index.ng-star-inserted > input", "8")
	 System.out.println("ISSUE WITH OPTION css=section.display-sheets > table > tbody > tr:nth-child(1) > td:nth-of-type(4) > mat-checkbox > label > div");
	 selenium.click("css=section.display-sheets > table > tbody > tr:nth-child(1) > td:nth-of-type(5) > mat-checkbox > label > div")
	 selenium.fireEvent("css= td.cdk-column-xls_sheet_index.mat-column-xls_sheet_index > input", "change")
	 selenium.click("css=app-document-settings > mat-dialog-actions > button.mat-raised-button.mat-accent")
	 selenium.click("css=app-document > section > subreport > div > sheet > mat-card > div > div > button > span > span")
	 selenium.type("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div > div:nth-child(2) > div:nth-child(2) > input", "12")
	 selenium.select("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div > div:nth-child(3) > div:nth-child(1) > select", "value=;")
	 selenium.click("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div:nth-child(2) > button")
	 Thread.sleep(1500);
	 selenium.refresh()
	 selenium.waitForPageToLoad("")
	 selenium.click("css=app-document > section > subreport > div > sheet > mat-card > div > div > button > span > span")
	 selenium.type("css=input#fileUpload", "${biggerCsvFullPath}")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div.preview-info")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 String currentDate = selenium.getEval("var today = new Date(); today.toISOString().substring(0,10);")
	 verifyEquals("CSV of iteration " + currentDate + " - Total rows : 795", selenium.getText("css=div.preview-info"));
	 assertEquals("First line of first CSVDate/Time Generated2/20/19 4:39 AMReport Time ZoneEurope/ParisAccount ID743372Date Range2/19/19 - 2/19/19AdvertiserEquals:FR Orange Internet (8364571)AdvertiserEquals:FR Orange Mobile (8365738)AdvertiserEquals:FR Sosh Internet (8364841)AdvertiserEquals:FR Sosh Mobile (8364118)MRC Accredited MetricsNoneReport Fields", selenium.getText("css=table.preview-table:nth-of-type(1)"));
	 verifyTrue(selenium.isVisible("css=div.spliter"));
	 verifyEquals("FR Sosh Mobile22275335_tradelab_stvalentin_std_300x50_cpm_mob_dis-iab_prosp_npa_prospectionalgo_dbm_ _sosh_kpi4-terminaux-mobile_kpi4-terminaux-mobile19/02/20199.550.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22275335_tradelab_stvalentin_std_300x600_cpm_web_dis-iab_prosp_npa_profiling_dbm_2nd-tl_sosh_kpi4-terminaux-mobile19/02/20190.720.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22275335_tradelab_stvalentin_std_300x600_cpm_web_dis-iab_prosp_npa_profiling_dbm_3rd-classique_sosh_kpi4-terminaux-mobile19/02/2019162.900.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22275335_tradelab_stvalentin_std_300x600_cpm_web_dis-iab_prosp_npa_prospectionalgo_dbm_ _sosh_kpi4-terminaux-mobile_kpi4-terminaux-mobile19/02/201963.250.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22275335_tradelab_stvalentin_std_320x50_cpm_mob_dis-iab_prosp_npa_prospectionalgo_dbm_ _sosh_kpi4-terminaux-mobile_kpi4-terminaux-mobile19/02/201930.550.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22275335_tradelab_stvalentin_std_728x90_cpm_web_dis-iab_prosp_npa_profiling_dbm_2nd-tl_sosh_kpi4-terminaux-mobile19/02/20190.620.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22275335_tradelab_stvalentin_std_728x90_cpm_web_dis-iab_prosp_npa_profiling_dbm_3rd-classique_sosh_kpi4-terminaux-mobile19/02/2019124.150.000.000.000.004.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22275335_tradelab_stvalentin_std_728x90_cpm_web_dis-iab_prosp_npa_prospectionalgo_dbm_ _sosh_kpi4-terminaux-mobile_kpi4-terminaux-mobile19/02/201942.060.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22275335_tradelab_stvalentin_std_970x250_cpm_web_dis-eve_prosp_npa_profiling_dbm_2nd-tl_sosh_kpi4-terminaux-mobile_kpi4-terminaux-mobile19/02/20190.050.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22275335_tradelab_stvalentin_std_970x250_cpm_web_dis-eve_prosp_npa_profiling_dbm_3rd-classique_sosh_kpi4-terminaux-mobile_kpi4-terminaux-mobile19/02/20198.050.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00", selenium.getText("css=table.preview-table:nth-of-type(2)"));
	 selenium.click("css=document-setup > div > div > button:nth-of-type(3)")
	 selenium.if("${downloadReport} == 1")
	 String waitForReport = "5000"
	 String remainingAttempts = "40"
	 boolean canDownloadReport = selenium.isElementPresent("css=div.cdk-overlay-pane > div > div > button[aria-disabled=\"false\"]")
	 selenium.while(canDownloadReport + " == 0 && " + remainingAttempts + " > 0")
	 Thread.sleep(NaN);
	 selenium.refresh()
	 selenium.waitForPageToLoad("")
	 selenium.click("css=document-setup > div > div > button:nth-of-type(3)")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div.cdk-overlay-pane > div > div > button")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 boolean canDownloadReport = selenium.isElementPresent("css=div.cdk-overlay-pane > div > div > button[aria-disabled=\"false\"]")
	 String remainingAttempts = selenium.getEval("remainingAttempts - 1")
	 selenium.endWhile()
	 selenium.click("css=div.cdk-overlay-pane > div > div > button[aria-disabled=\"false\"]")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=snack-bar-container > simple-snack-bar")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.endIf()
	 // Start from row 12 + Exclude last 12
	 selenium.click("css=button[id=\"button-new-report\"]")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=button[id=\"button-new-basic-report\"]")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=button[id=\"button-new-basic-report\"]")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div > mat-dialog-container")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=mat-dialog-content div.mat-form-field-flex > div > mat-select")
	 Thread.sleep(500);
	 selenium.click("css=div[class=\"cdk-overlay-pane\"] > div > mat-option:nth-child(1)")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div.mat-form-field-infix > input.mat-input-element")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.type("css=div.mat-form-field-infix > input.mat-input-element", "Test auto - Report - Start from row 12 + Exclude last 12")
	 selenium.click("css=app-new-document-dialog > form > mat-dialog-actions > button.mat-raised-button.mat-accent > span")
	 Thread.sleep(1000);
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (!selenium.isVisible("css=div.preview-info")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=subreport > div > header > div > button > span > i")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div.mat-menu-content > button:nth-child(1)")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=div.mat-menu-content > button:nth-child(1)")
	 Thread.sleep(1500);
	 boolean isSubreportCreated = selenium.isElementPresent("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > i")
	 selenium.if(isSubreportCreated + " == 0")
	 selenium.click("css=div.mat-menu-content > button:nth-of-type(1)")
	 selenium.endIf()
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > i")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > i")
	 selenium.type("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > input", "Start from row 12 + Exclude last 12 Subreport")
	 selenium.fireEvent("css=subreport > div > header > tab-sheet:nth-child(1) > div > div.title > contenteditable > div > input", "blur")
	 selenium.click("css=document-setup > mat-card > mat-card-content > div.option.schedule > button")
	 selenium.click("css=sat-datepicker-toggle > button")
	 selenium.click("css=.mat-calendar-body-today")
	 selenium.click("css=.mat-calendar-body-today")
	 selenium.click("css=document-scheduler > div.mat-dialog-actions > button.mat-raised-button.mat-accent")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (!selenium.isVisible("xpath=//*[text()='No report yet']")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.type("css=document-setup > mat-card > mat-card-content > div:nth-child(3) > form > button > span > input", "${templateFullPath}")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=document-setup > mat-card > mat-card-content > div:nth-child(3) > button:nth-of-type(2)")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.click("css=document-setup > mat-card > mat-card-content > div:nth-child(3) > button:nth-of-type(2)")
	 selenium.type("css=section.display-sheets > table > tbody > tr:nth-child(1) > td.mat-cell.cdk-column-xls_sheet_index.mat-column-xls_sheet_index.ng-star-inserted > input", "8")
	 System.out.println("ISSUE WITH OPTION css=section.display-sheets > table > tbody > tr:nth-child(1) > td:nth-of-type(4) > mat-checkbox > label > div");
	 selenium.click("css=section.display-sheets > table > tbody > tr:nth-child(1) > td:nth-of-type(5) > mat-checkbox > label > div")
	 selenium.fireEvent("css= td.cdk-column-xls_sheet_index.mat-column-xls_sheet_index > input", "change")
	 selenium.click("css=app-document-settings > mat-dialog-actions > button.mat-raised-button.mat-accent")
	 selenium.click("css=app-document > section > subreport > div > sheet > mat-card > div > div > button > span > span")
	 selenium.type("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div > div:nth-child(2) > div:nth-child(1) > input", "12")
	 selenium.type("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div > div:nth-child(2) > div:nth-child(2) > input", "12")
	 selenium.select("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div > div:nth-child(3) > div:nth-child(1) > select", "value=;")
	 selenium.click("css=app-document > section > subreport > div > sheet > mat-card > csv-settings > div > div > form > div:nth-child(2) > button")
	 Thread.sleep(1500);
	 selenium.refresh()
	 selenium.waitForPageToLoad("")
	 selenium.click("css=app-document > section > subreport > div > sheet > mat-card > div > div > button > span > span")
	 selenium.type("css=input#fileUpload", "${biggerCsvFullPath}")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div.preview-info")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 String currentDate = selenium.getEval("var today = new Date(); today.toISOString().substring(0,10);")
	 verifyEquals("CSV of iteration " + currentDate + " - Total rows : 784", selenium.getText("css=div.preview-info"));
	 assertEquals("Header of first CSV at line 12PlacementDateDBM Cost (Account Currency)OR-Mobile_2018-01_Sales : or_mobile_cv_acquisition-terminal _2018-01: Total ConversionsOR-Mobile_2018-01_Sales : or_mobile_cv_fidelisation-terminal_2018-01: Total ConversionsOR-Mobile_2018-01_Sales : or_mobile_cv_acquisition-forfait-multi-ligne_2018-01: Total ConversionsOR-Mobile_2018-01_Sales : or_mobile_cv_acquisition-forfait_2018-01: Total ConversionsSH-Mobile_2018-01_Sales : sh_mobile_cv_acquisition-offre-mobile_2018-01: Total ConversionsSH-Mobile_2018-01_Sales : sh_mobile_cv_acquisition-terminal _2018-01: Total ConversionsOR-FAI_2018-01_Sales : or_fai_cv_confirmation-acquisition-internet-fibre_2018-01: Total ConversionsOR-FAI_2018-01_Sales : or_fai_cv_confirmation-migration-xdsl-vers-fibre_2018-01: Total ConversionsOR-Open_2018-01_Sales : or_open_cv_acquisition-open-fibre_2018-05: Total ConversionsOR-Open_2018-01_Sales : or_open_cv_migration-open-xdsl-vers-fibre_2018-01: Total ConversionsOR-FAI_2018-01_Sales : or_fai_cv_confirmation-acquisition-internet-xdsl_2018-01: Total ConversionsOR-Open_2018-01_Sales : or_open_cv_acquisition-open-xdsl_2018-01: Total ConversionsSH-Mobile-Livebox_2018-01_Sales : sh_mobile-livebox_cv_acq-offre-convergente_2018-01: Total ConversionsSH-Box-Internet_2018-08_Sales : sh_box-internet_cv_confirmation-acquisition-internet-adsl_2018-08: Total ConversionsSH-Box-Internet_2018-08_Sales : sh_box-internet_cv_confirmation-acquisition-internet-fibre_2018-10: Total ConversionsFR Orange Internet22183140_tradelab_odr_pcc_multi-format-native1_cpm_mob_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20194.080.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_pcc_multi-format-native1_cpm_web_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20190.830.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_pcc_multi-format-native2_cpm_mob_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20195.290.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_pcc_multi-format-native2_cpm_web_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20194.570.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_pcc_multi-format-native3_cpm_mob_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20194.480.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_pcc_multi-format-native3_cpm_web_dis-nat_rtg_npa_retargeting_dbm_1st-tms_or-fai_kpi1-acquisition-bb19/02/20194.620.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_std_120x600_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms__or-fai_kpi1-acquisition-bb19/02/20191.540.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_std_160x600_cpm_web_dis-iab_rtg_npa_retargeting_dbm_1st-tms__or-fai_kpi1-acquisition-bb19/02/201910.060.000.000.000.000.000.001.000.000.000.000.000.000.001.000.00FR Orange Internet22183140_tradelab_odr_std_1800x1000_cpm_web_dis-eve_rtg_npa_retargeting_dbm_1st-tms__or-fai_kpi1-acquisition-bb19/02/201910.210.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Orange Internet22183140_tradelab_odr_std_300x250_cpm_mob_dis-iab_rtg_npa_retargeting_dbm_1st-tms__or-fai_kpi1-acquisition-bb19/02/201927.220.000.000.000.000.000.000.000.000.000.001.000.000.000.000.00", selenium.getText("css=table.preview-table:nth-of-type(1)"));
	 verifyTrue(selenium.isVisible("css=div.spliter"));
	 verifyEquals("FR Sosh Mobile22275335_tradelab_stvalentin_std_300x50_cpm_mob_dis-iab_prosp_npa_prospectionalgo_dbm_ _sosh_kpi4-terminaux-mobile_kpi4-terminaux-mobile19/02/20199.550.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22275335_tradelab_stvalentin_std_300x600_cpm_web_dis-iab_prosp_npa_profiling_dbm_2nd-tl_sosh_kpi4-terminaux-mobile19/02/20190.720.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22275335_tradelab_stvalentin_std_300x600_cpm_web_dis-iab_prosp_npa_profiling_dbm_3rd-classique_sosh_kpi4-terminaux-mobile19/02/2019162.900.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22275335_tradelab_stvalentin_std_300x600_cpm_web_dis-iab_prosp_npa_prospectionalgo_dbm_ _sosh_kpi4-terminaux-mobile_kpi4-terminaux-mobile19/02/201963.250.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22275335_tradelab_stvalentin_std_320x50_cpm_mob_dis-iab_prosp_npa_prospectionalgo_dbm_ _sosh_kpi4-terminaux-mobile_kpi4-terminaux-mobile19/02/201930.550.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22275335_tradelab_stvalentin_std_728x90_cpm_web_dis-iab_prosp_npa_profiling_dbm_2nd-tl_sosh_kpi4-terminaux-mobile19/02/20190.620.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22275335_tradelab_stvalentin_std_728x90_cpm_web_dis-iab_prosp_npa_profiling_dbm_3rd-classique_sosh_kpi4-terminaux-mobile19/02/2019124.150.000.000.000.004.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22275335_tradelab_stvalentin_std_728x90_cpm_web_dis-iab_prosp_npa_prospectionalgo_dbm_ _sosh_kpi4-terminaux-mobile_kpi4-terminaux-mobile19/02/201942.060.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22275335_tradelab_stvalentin_std_970x250_cpm_web_dis-eve_prosp_npa_profiling_dbm_2nd-tl_sosh_kpi4-terminaux-mobile_kpi4-terminaux-mobile19/02/20190.050.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00FR Sosh Mobile22275335_tradelab_stvalentin_std_970x250_cpm_web_dis-eve_prosp_npa_profiling_dbm_3rd-classique_sosh_kpi4-terminaux-mobile_kpi4-terminaux-mobile19/02/20198.050.000.000.000.000.000.000.000.000.000.000.000.000.000.000.00", selenium.getText("css=table.preview-table:nth-of-type(2)"));
	 selenium.click("css=document-setup > div > div > button:nth-of-type(3)")
	 selenium.if("${downloadReport} == 1")
	 String waitForReport = "5000"
	 String remainingAttempts = "40"
	 boolean canDownloadReport = selenium.isElementPresent("css=div.cdk-overlay-pane > div > div > button[aria-disabled=\"false\"]")
	 selenium.while(canDownloadReport + " == 0 && " + remainingAttempts + " > 0")
	 Thread.sleep(NaN);
	 selenium.refresh()
	 selenium.waitForPageToLoad("")
	 selenium.click("css=document-setup > div > div > button:nth-of-type(3)")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=div.cdk-overlay-pane > div > div > button")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 boolean canDownloadReport = selenium.isElementPresent("css=div.cdk-overlay-pane > div > div > button[aria-disabled=\"false\"]")
	 String remainingAttempts = selenium.getEval("remainingAttempts - 1")
	 selenium.endWhile()
	 selenium.click("css=div.cdk-overlay-pane > div > div > button[aria-disabled=\"false\"]")
	 for (int second = 0;; second++) {
	 if (second >= 60) fail("timeout");
	 try { if (selenium.isVisible("css=snack-bar-container > simple-snack-bar")) break; } catch (Exception e) {}
	 Thread.sleep(1000);
	 }
	 selenium.endIf()
	 }
}
